<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cute LT Plate Generator</title>
    <style>
        :root {
            --bg-sky: #bae6fd;
            --road: #64748b;
            --primary: #fda4af;
            --accent: #f43f5e;
        }
        body {
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f9ff;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            touch-action: manipulation;
        }
        #app-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 24px;
            padding: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            width: 100%;
            height: auto;
            background: linear-gradient(to bottom, #7dd3fc, #bae6fd);
            border-radius: 18px;
            display: block;
        }
        .controls {
            width: 100%;
            padding: 20px 0;
            text-align: center;
        }
        button {
            width: 80%;
            padding: 18px;
            font-size: 20px;
            font-weight: bold;
            color: white;
            background-color: var(--primary);
            border: none;
            border-radius: 50px;
            box-shadow: 0 6px 0 var(--accent);
            transition: all 0.1s;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }
        button:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 var(--accent);
        }
        #history-section {
            width: 100%;
            max-width: 500px;
            margin-top: 20px;
            background: white;
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }
        h3 { color: #475569; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; margin-top: 0; }
        .plate-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 150px;
            overflow-y: auto;
        }
        .plate-item {
            background: #f1f5f9;
            padding: 5px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 14px;
            border-left: 4px solid var(--accent);
            animation: popIn 0.3s ease-out;
        }
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

    <div id="app-container">
        <canvas id="gameCanvas" width="400" height="250"></canvas>
        <div class="controls">
            <button id="goBtn">GO! ðŸš¦</button>
        </div>
    </div>

    <div id="history-section">
        <h3>Generated Plates</h3>
        <div class="plate-list" id="plateHistory"></div>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const btn = document.getElementById('goBtn');
    const historyList = document.getElementById('plateHistory');

    // RoundRect Polyfill
    if (!CanvasRenderingContext2D.prototype.roundRect) {
        CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
            if (w < 2 * r) r = w / 2;
            if (h < 2 * r) r = h / 2;
            this.beginPath();
            this.moveTo(x + r, y);
            this.arcTo(x + w, y, x + w, y + h, r);
            this.arcTo(x + w, y + h, x, y + h, r);
            this.arcTo(x, y + h, x, y, r);
            this.arcTo(x, y, x + w, y, r);
            this.closePath();
            return this;
        };
    }

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playTone(freq, type, dur, vol=0.05) {
        try {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + dur);
        } catch(e) {}
    }

    // App State
    let state = 'ENTERING'; // ENTERING, STOPPED, EXITING
    let lightStatus = 'RED'; // RED, YELLOW, GREEN
    let carX = -150;
    let carColor = '#fda4af';
    let currentPlate = generatePlate();
    let bounce = 0;
    let clouds = [{x: 50, y: 30}, {x: 250, y: 50}];

    function generatePlate() {
        const letters = "ABCDEFGHIJKLMNPRSTUVZ";
        let res = "";
        for(let i=0; i<3; i++) res += letters.charAt(Math.floor(Math.random()*letters.length));
        res += " " + (Math.floor(Math.random()*899) + 100);
        return res;
    }

    function addHistory(plate) {
        const item = document.createElement('div');
        item.className = 'plate-item';
        item.innerText = plate;
        historyList.prepend(item);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Clouds
        ctx.fillStyle = "white";
        clouds.forEach(c => {
            ctx.beginPath();
            ctx.arc(c.x, c.y, 15, 0, Math.PI*2);
            ctx.arc(c.x + 10, c.y - 10, 12, 0, Math.PI*2);
            ctx.arc(c.x + 20, c.y, 15, 0, Math.PI*2);
            ctx.fill();
            c.x += 0.2;
            if(c.x > 450) c.x = -50;
        });

        // Road
        ctx.beginPath();
        ctx.fillStyle = "#94a3b8";
        ctx.fillRect(0, 200, 400, 50);
        ctx.fillStyle = "rgba(255,255,255,0.4)";
        for(let i=0; i<5; i++) ctx.fillRect(i*100 + 20, 222, 40, 4);

        // Traffic Light Box
        ctx.beginPath();
        ctx.fillStyle = "#334155";
        ctx.roundRect(320, 40, 34, 100, 10);
        ctx.fill();
        ctx.fillRect(334, 140, 6, 60);
        
        // RED Light
        ctx.beginPath(); 
        ctx.shadowBlur = (lightStatus === 'RED') ? 15 : 0;
        ctx.shadowColor = "#ff4d6d";
        ctx.fillStyle = (lightStatus === 'RED') ? "#ff4d6d" : "#441b24";
        ctx.arc(337, 58, 10, 0, Math.PI*2); ctx.fill();
        
        // YELLOW Light
        ctx.beginPath();
        ctx.shadowBlur = (lightStatus === 'YELLOW') ? 15 : 0;
        ctx.shadowColor = "#fbbf24";
        ctx.fillStyle = (lightStatus === 'YELLOW') ? "#fbbf24" : "#42320a"; 
        ctx.arc(337, 90, 10, 0, Math.PI*2); ctx.fill();

        // GREEN Light
        ctx.beginPath(); 
        ctx.shadowBlur = (lightStatus === 'GREEN') ? 15 : 0;
        ctx.shadowColor = "#2dd4bf";
        ctx.fillStyle = (lightStatus === 'GREEN') ? "#2dd4bf" : "#132d29";
        ctx.arc(337, 122, 10, 0, Math.PI*2); ctx.fill();
        ctx.shadowBlur = 0;

        // Car
        ctx.beginPath(); 
        ctx.save();
        ctx.translate(carX, 160 + bounce);
        ctx.fillStyle = carColor;
        ctx.roundRect(0, 0, 120, 45, 15); ctx.fill(); // Body
        ctx.roundRect(25, -30, 70, 40, 15); ctx.fill(); // Roof
        ctx.fillStyle = "#e0f2fe"; // Windows
        ctx.roundRect(32, -22, 25, 25, 5); ctx.fill();
        ctx.roundRect(62, -22, 25, 25, 5); ctx.fill();
        ctx.fillStyle = "#1e293b"; // Wheels
        ctx.beginPath(); ctx.arc(30, 45, 14, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(90, 45, 14, 0, Math.PI*2); ctx.fill();
        // Plate
        ctx.fillStyle = "white";
        ctx.fillRect(35, 12, 50, 20);
        ctx.fillStyle = "black";
        ctx.font = "bold 11px monospace";
        ctx.textAlign = "center";
        ctx.fillText(currentPlate, 60, 26);
        ctx.restore();

        update();
        requestAnimationFrame(draw);
    }

    function update() {
        if(state === 'ENTERING') {
            carX += 3;
            if(carX >= 110) {
                carX = 110;
                state = 'STOPPED';
                doBounce();
                playTone(300, 'sine', 0.1);
            }
        } else if (state === 'STOPPED') {
            bounce = Math.sin(Date.now() * 0.01) * 0.5; // Idle vibe
        } else if (state === 'EXITING') {
            carX += 6;
            if(carX > 450) {
                resetCar();
            }
        }
    }

    function doBounce() {
        let v = 0;
        let itv = setInterval(() => {
            bounce = Math.sin(v) * 6;
            v += 0.5;
            if(v > 6.2) { clearInterval(itv); bounce = 0; }
        }, 20);
    }

    function resetCar() {
        carX = -150;
        currentPlate = generatePlate();
        const colors = ['#fda4af', '#93c5fd', '#86efac', '#fde047', '#d8b4fe'];
        carColor = colors[Math.floor(Math.random()*5)];
        lightStatus = 'RED';
        state = 'ENTERING';
    }

    btn.addEventListener('click', () => {
        if(state === 'STOPPED' && lightStatus === 'RED') {
            addHistory(currentPlate);
            
            // Sequence: Red -> Yellow -> Green
            lightStatus = 'YELLOW';
            playTone(400, 'sine', 0.1);

            setTimeout(() => {
                lightStatus = 'GREEN';
                playTone(600, 'triangle', 0.2);
                
                // Reaction time before driving
                setTimeout(() => {
                    state = 'EXITING';
                    playTone(150, 'sawtooth', 0.6, 0.03);
                }, 300);
            }, 600);
        }
    });

    draw();
</script>
</body>
</html>