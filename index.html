<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">Cosmic Wonders Explorer</title>
    <style>
        :root {
            /* Exoplanets Theme */
            --bg-color-primary: #001A00;
            --bg-color-secondary: #002A00;
            --text-color: #CCFFCC; /* Light Green */
            --footer-bg: #001000;
            --footer-text-color: #AADDAA; /* Medium Light Green */
            --glass-bg: rgba(0, 42, 0, 0.7);
            --glass-border: rgba(153, 204, 153, 0.3);
            --fact-text-shadow: 0 0 15px rgba(204, 255, 204, 0.8);
            --title-color: #FFFFFF;
            --title-shadow: 0 0 25px rgba(255, 255, 255, 0.9);
            --main-action-btn: #32CD32; /* Lime Green */
            --main-action-btn-hover: #228B22; /* Forest Green */
            --explore-glow-color: #7CFC00; /* Lawn Green */
            --explore-text-initial: rgba(204, 255, 204, 0.4);
            --explore-text-active: #CCFFCC;
            --fact-card-bg: rgba(0, 0, 0, 0.8);
            --fact-card-border: rgba(124, 252, 0, 0.7);
            --fact-of-day-glow: 0 0 25px rgba(124, 252, 0, 0.9);
            --stellar-scan-bg-primary: #000000;
            --stellar-scan-bg-secondary: #000005;
            --stellar-scan-indicator: #7CFC00; /* Lawn Green */
            --stellar-scan-text: #7CFC00; /* Lawn Green */

            /* Anomaly Detector */
            --anomaly-bg: rgba(255, 69, 0, 0.8); /* OrangeRed */
            --anomaly-text: #FFFFFF;
            --anomaly-border: #FFD700; /* Gold */
            --anomaly-glow: 0 0 20px rgba(255, 69, 0, 0.9);

            /* Riddle Feature */
            --riddle-input-bg: rgba(255, 255, 255, 0.1);
            --riddle-input-border: rgba(255, 255, 255, 0.3);
            --riddle-input-text: #F0E0FF;
            --riddle-button-bg: #00BFFF; /* Deep Sky Blue */
            --riddle-button-hover: #008ECC; /* Darker Deep Sky Blue */

            /* Cosmic Alignment Scan */
            --scan-line-color: #00FFFF; /* Cyan */
            --scan-overlay-bg: rgba(0, 0, 0, 0.95);
            --scan-overlay-text: #00FFFF;
            --scan-overlay-glow: 0 0 30px #00FFFF;

            /* Quantum Data Stream */
            --quantum-stream-bg: rgba(0, 0, 0, 0.98);
            --quantum-stream-text: #00FF00; /* Bright Green */
            --quantum-stream-glow: 0 0 20px rgba(0, 255, 0, 0.8);
            --quantum-stream-line: rgba(0, 255, 0, 0.5);
        }

        body {
            background: linear-gradient(135deg, var(--bg-color-primary) 0%, var(--bg-color-secondary) 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            transition: background 1.5s ease-in-out, color 0.8s ease;
            overflow-x: hidden;
            position: relative;
        }

        body.stellar-scanned {
            background: linear-gradient(135deg, var(--stellar-scan-bg-primary) 0%, var(--stellar-scan-bg-secondary) 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            background: var(--glass-bg);
            border-radius: 25px;
            padding: 40px 60px;
            margin: auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            max-width: 900px;
            width: 90%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease-in-out;
        }

        h1 {
            color: var(--title-color);
            text-shadow: var(--title-shadow);
            font-size: 3.5em;
            margin-bottom: 20px;
            letter-spacing: 2px;
            transition: color 0.5s ease, text-shadow 0.5s ease;
        }

        .fact-card {
            background: var(--fact-card-bg);
            border: 1px solid var(--fact-card-border);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--fact-of-day-glow);
            max-width: 700px;
            margin: 20px 0;
            transition: all 0.5s ease-in-out, transform 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: fadeInScale 0.8s ease-out; /* New animation for fact card */
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .fact-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 35px var(--explore-glow-color); /* Stronger glow on hover */
        }

        .fact-card h2 {
            color: var(--explore-glow-color);
            font-size: 2.2em;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(218, 112, 214, 0.5);
        }

        .fact-text {
            font-size: 1.8em; /* Increased font size */
            line-height: 1.6;
            color: var(--explore-text-initial); /* Initially dim */
            text-shadow: none;
            transition: color 1s ease, text-shadow 1s ease;
        }

        .fact-text.revealed {
            color: var(--explore-text-active); /* Bright when revealed */
            text-shadow: var(--fact-text-shadow);
            animation: textFadeIn 1s ease-out; /* New animation for text reveal */
        }

        @keyframes textFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .action-button {
            background-color: var(--main-action-btn);
            color: #FFFFFF; /* White text on bright button */
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
        }

        .action-button:hover:not(:disabled) {
            background-color: var(--main-action-btn-hover);
            transform: translateY(-3px);
            box-shadow: 0 0 25px var(--main-action-btn-hover);
        }

        .action-button:disabled {
            background-color: var(--main-action-btn-hover);
            cursor: default;
            opacity: 0.7;
            box-shadow: none;
        }

        .riddle-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }

        .riddle-input {
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid var(--riddle-input-border);
            background-color: var(--riddle-input-bg);
            color: var(--riddle-input-text);
            font-size: 1.1em;
            width: 80%;
            max-width: 400px;
            text-align: center;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .riddle-input:focus {
            outline: none;
            border-color: var(--riddle-button-bg);
            box-shadow: 0 0 10px var(--riddle-button-bg);
        }

        .riddle-button {
            background-color: var(--riddle-button-bg);
            color: #FFFFFF;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-weight: bold;
        }

        .riddle-button:hover:not(:disabled) {
            background-color: var(--riddle-button-hover);
            transform: translateY(-2px);
        }

        .riddle-button:disabled {
            background-color: var(--riddle-button-hover);
            cursor: default;
            opacity: 0.7;
        }

        footer {
            margin-top: 50px;
            padding: 20px;
            background-color: var(--footer-bg);
            color: var(--footer-text-color);
            width: 100%;
            box-sizing: border-box;
            border-top: 1px solid var(--glass-border);
            font-size: 0.9em;
            position: relative;
            z-index: 10;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* Stardust Particle Effect */
        .stardust-particle {
            position: absolute;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.5) 50%, rgba(255, 255, 255, 0) 100%);
            border-radius: 50%;
            opacity: 0;
            animation: stardustFloatAndGlow 20s infinite ease-in-out, shimmer 3s infinite alternate;
            z-index: -1;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.7);
        }

        @keyframes stardustFloatAndGlow {
            0% { opacity: 0; transform: translate(0, 100vh) scale(0.2); }
            15% { opacity: 0.6; transform: translate(10vw, 80vh) scale(0.8); }
            30% { opacity: 0.4; transform: translate(30vw, 95vh) scale(0.5); }
            45% { opacity: 0.7; transform: translate(50vw, 75vh) scale(1.0); }
            60% { opacity: 0.5; transform: translate(70vw, 90vh) scale(0.7); }
            75% { opacity: 0.8; transform: translate(90vw, 70vh) scale(1.1); }
            100% { opacity: 0; transform: translate(100vw, 100vh) scale(0.3); }
        }

        @keyframes shimmer {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(1.05); opacity: 0.9; }
        }

        /* Stellar Scan Feature */
        .stellar-scan-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none; /* Hidden by default */
            flex-direction: column;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 30px var(--main-action-btn);
            z-index: 100;
            width: 200px;
            border: 1px solid var(--main-action-btn);
        }

        .stellar-scan-container.active {
            display: flex;
        }

        .stellar-scanner-bar {
            width: 10px;
            height: 150px;
            background: linear-gradient(to top, var(--main-action-btn), var(--bg-color-secondary));
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--glass-border);
        }

        .stellar-indicator {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--stellar-scan-indicator);
            height: 0%;
            transition: height 5s ease-out; /* Animation for scan */
        }

        .stellar-text {
            font-size: 1.5em;
            color: var(--stellar-scan-text);
            text-shadow: var(--title-shadow);
        }

        /* Cosmic Sparkle for fact card hover */
        .cosmic-sparkle {
            position: absolute;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.5) 50%, rgba(255, 255, 255, 0) 100%);
            border-radius: 50%;
            animation: sparkle-fade-out 0.8s forwards;
            pointer-events: none;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.7);
        }

        @keyframes sparkle-fade-out {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        /* Anomaly Detector Overlay */
        .anomaly-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }

        .anomaly-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .anomaly-content {
            background: var(--anomaly-bg);
            border: 2px solid var(--anomaly-border);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--anomaly-glow);
            color: var(--anomaly-text);
            font-size: 2em;
            text-align: center;
            max-width: 700px;
            transform: scale(0.8);
            opacity: 0;
            animation: anomaly-reveal 0.8s forwards;
        }

        @keyframes anomaly-reveal {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Cosmic Alignment Scan Feature - Full Screen Overlay */
        .scan-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--scan-overlay-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 150;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }

        .scan-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .scan-overlay-content {
            color: var(--scan-overlay-text);
            font-size: 2.5em;
            text-shadow: var(--scan-overlay-glow);
            animation: text-scan 2s infinite alternate;
            margin-bottom: 30px;
        }

        .scan-detail-text {
            font-size: 1.5em;
            color: var(--scan-overlay-text);
            opacity: 0;
            transform: translateY(20px);
            animation: detail-reveal 1s forwards 2s; /* Delay reveal */
            max-width: 80%;
            line-height: 1.5;
        }

        @keyframes text-scan {
            0% { opacity: 0.5; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.05); }
        }

        @keyframes detail-reveal {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .scan-progress-bar {
            width: 300px;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 20px;
        }

        .scan-progress {
            width: 0%;
            height: 100%;
            background: linear-gradient(to right, transparent, var(--scan-line-color));
            animation: progress-fill 3s forwards;
        }

        @keyframes progress-fill {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        /* Quantum Data Stream Overlay */
        .quantum-stream-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--quantum-stream-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        .quantum-stream-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .quantum-stream-text {
            color: var(--quantum-stream-text);
            font-size: 3em;
            text-shadow: var(--quantum-stream-glow);
            margin-bottom: 30px;
            overflow: hidden; /* Ensures text appears letter by letter */
            white-space: nowrap; /* Keeps text on a single line */
            border-right: 0.15em solid var(--quantum-stream-text); /* Typing cursor */
            animation: typing 2s steps(20, end) forwards, blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--quantum-stream-text); }
        }

        .quantum-stream-lines-container {
            position: relative;
            width: 80%;
            height: 100px;
            overflow: hidden;
        }

        .quantum-stream-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--quantum-stream-line);
            opacity: 0;
            animation: stream-line-flow 3s infinite linear;
        }

        .quantum-stream-line:nth-child(1) { animation-delay: 0s; top: 10%; }
        .quantum-stream-line:nth-child(2) { animation-delay: 0.5s; top: 30%; }
        .quantum-stream-line:nth-child(3) { animation-delay: 1s; top: 50%; }
        .quantum-stream-line:nth-child(4) { animation-delay: 1.5s; top: 70%; }
        .quantum-stream-line:nth-child(5) { animation-delay: 2s; top: 90%; }

        @keyframes stream-line-flow {
            0% { transform: translateX(-100%); opacity: 0; }
            20% { opacity: 1; }\
            80% { opacity: 1; }\
            100% { transform: translateX(100%); opacity: 0; }
        }

        /* Cosmic Echoes Feature */
        .cosmic-echoes-container {
            position: fixed;
            bottom: 80px; /* Above the footer */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            box-shadow: 0 0 15px rgba(124, 252, 0, 0.5); /* Glow matching exoplanet theme */
            z-index: 10;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(124, 252, 0, 0.3);
            max-width: 90%;
            overflow-x: auto;
            white-space: nowrap;
        }

        .cosmic-echo {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 8px 15px;
            color: var(--text-color);
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
            flex-shrink: 0; /* Prevent shrinking */
        }

        .cosmic-echo:hover {
            background: rgba(255, 255, 255, 0.2);
            opacity: 1;
            transform: translateY(-3px);
            box-shadow: 0 0 10px var(--explore-glow-color);
        }

        .cosmic-echo.active {
            background: var(--main-action-btn);
            color: #FFFFFF;
            opacity: 1;
            border-color: var(--explore-glow-color);
            box-shadow: 0 0 15px var(--explore-glow-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cosmic Wonders Explorer</h1>
        <div class="fact-card" id="factCard">
            <h2 id="fact-title">Exoplanets: Worlds Beyond Our Solar System</h2>
            <p id="main-fact" class="fact-text" style="display: none;">Thousands of exoplanets have been discovered, orbiting stars other than our Sun, with many potentially habitable.</p>
            <p id="fact-detail" class="fact-text" style="display: none; font-size: 1.2em; margin-top: 15px;">These distant worlds offer a glimpse into the diversity of planetary systems in our galaxy and fuel the search for extraterrestrial life.</p>

            <div id="riddleSection" class="riddle-section" style="display: none;">
                <p id="riddle-text" class="fact-text"></p>
                <input type="text" id="riddleInput" class="riddle-input" placeholder="Your answer, explorer...">
                <button class="riddle-button" id="solveRiddleButton" onclick="solveRiddle()">Solve Riddle</button>
                <p id="riddle-feedback" style="color: red; font-weight: bold;"></p>
            </div>

            <div class="button-group">
                <button class="action-button" id="revealFactButton" onclick="revealFact()">Reveal Fact</button>
                <button class="action-button" id="deepDiveButton" onclick="activateDeepDive()">Cosmic Alignment Scan</button>
                <button class="action-button" id="anomalyDetectorButton" onclick="activateAnomalyDetector()">Cosmic Anomaly Detector</button>
                <button class="action-button" id="newFactButton" onclick="initiateQuantumStream()">New Discovery</button>
            </div>
        </div>
    </div>

    <div class="stellar-scan-container" id="stellarScanContainer">
        <div class="stellar-scanner-bar">
            <div class="stellar-indicator" id="stellarIndicator"></div>
        </div>
        <p class="stellar-text" id="stellarStatus">Scanning...</p>
    </div>

    <div class="anomaly-overlay" id="anomalyOverlay">
        <div class="anomaly-content" id="anomalyContent">
            <!-- Anomaly fact will be inserted here -->
        </div>
    </div>

    <!-- Cosmic Alignment Scan Overlay -->
    <div class="scan-overlay" id="cosmicScanOverlay">
        <div class="scan-overlay-content">
            Initiating Cosmic Alignment Scan...
        </div>
        <div class="scan-progress-bar">
            <div class="scan-progress"></div>
        </div>
        <p id="scanDetailOverlayText" class="scan-detail-text"></p>
    </div>

    <!-- Quantum Data Stream Overlay -->
    <div class="quantum-stream-overlay" id="quantumStreamOverlay">
        <div class="quantum-stream-text" id="quantumStreamText"></div>
        <div class="quantum-stream-lines-container">
            <div class="quantum-stream-line"></div>
            <div class="quantum-stream-line"></div>
            <div class="quantum-stream-line"></div>
            <div class="quantum-stream-line"></div>
            <div class="quantum-stream-line"></div>
        </div>
    </div>

    <div class="cosmic-echoes-container" id="cosmicEchoesContainer">
        <!-- Cosmic Echoes will be dynamically added here -->
    </div>

    <script>
        const siteTitle = document.getElementById('site-title');
        const factTitle = document.getElementById('fact-title');
        const mainFact = document.getElementById('main-fact');
        const factDetail = document.getElementById('fact-detail');
        const factCard = document.getElementById('factCard');
        const deepDiveButton = document.getElementById('deepDiveButton');
        const anomalyDetectorButton = document.getElementById('anomalyDetectorButton');
        const newFactButton = document.getElementById('newFactButton');
        const revealFactButton = document.getElementById('revealFactButton');
        const stellarScanContainer = document.getElementById('stellarScanContainer');
        const stellarIndicator = document.getElementById('stellarIndicator');
        const stellarStatus = document.getElementById('stellarStatus');
        const anomalyOverlay = document.getElementById('anomalyOverlay');
        const anomalyContent = document.getElementById('anomalyContent');
        const riddleSection = document.getElementById('riddleSection');
        const riddleText = document.getElementById('riddle-text');
        const riddleInput = document.getElementById('riddleInput');
        const solveRiddleButton = document.getElementById('solveRiddleButton');
        const riddleFeedback = document.getElementById('riddle-feedback');
        const body = document.body;
        const root = document.documentElement;
        const cosmicScanOverlay = document.getElementById('cosmicScanOverlay');
        const scanDetailOverlayText = document.getElementById('scanDetailOverlayText');
        const quantumStreamOverlay = document.getElementById('quantumStreamOverlay');
        const quantumStreamText = document.getElementById('quantumStreamText');
        const cosmicEchoesContainer = document.getElementById('cosmicEchoesContainer');

        const facts = [
            {
                title: "The Great Attractor: A Cosmic Anomaly",
                main: "The Great Attractor is a mysterious gravitational anomaly in intergalactic space that is pulling our Milky Way galaxy and hundreds of thousands of other galaxies towards it.",
                detail: "Located about 150 to 250 million light-years away, this region of space is so massive that it's causing a significant \"bulk flow\" of galaxies, yet much of its mass is obscured by our own galaxy's dust and gas, making it difficult to observe directly.",
                anomaly: "Anomaly Detected: The Great Attractor's true nature might involve a supercluster of galaxies even larger than previously imagined, hidden behind the 'Zone of Avoidance'.",
                theme: {
                    '--bg-color-primary': '#1A0A1A',
                    '--bg-color-secondary': '#2A1A2A',
                    '--text-color': '#F0E0FF',
                    '--footer-bg': '#150C15',
                    '--footer-text-color': '#E0C0E0',
                    '--glass-bg': 'rgba(42, 26, 42, 0.7)',
                    '--glass-border': 'rgba(192, 160, 192, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(240, 224, 255, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#8B008B', /* Dark Magenta */
                    '--main-action-btn-hover': '#6A006A', /* Darker Dark Magenta */
                    '--explore-glow-color': '#FF00FF', /* Magenta */
                    '--explore-text-initial': 'rgba(240, 224, 255, 0.4)',
                    '--explore-text-active': '#F0E0FF',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(255, 0, 255, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(255, 0, 255, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#FF00FF', /* Magenta */
                    '--stellar-scan-text': '#FF00FF' /* Magenta */
                }
            },
            {\n                title: "Neutron Stars: Cosmic Powerhouses",\n                main: "Neutron stars are so dense that a single teaspoon of their material would weigh about 6 billion tons on Earth.",\n                detail: "These incredibly compact stellar remnants are formed from the collapsed cores of massive stars during supernova explosions. Their immense gravity and rapid rotation create extreme conditions unlike anything found on Earth.",\n                anomaly: "Anomaly Detected: Some neutron stars, known as magnetars, possess magnetic fields trillions of times stronger than Earth\'s, capable of distorting spacetime.",\n                theme: {\n                    \'--bg-color-primary\': \'#0A0A1A\',\n                    \'--bg-color-secondary\': \'#1A0A2A\',\n                    \'--text-color\': \'#E0E0FF\',\n                    \'--footer-bg\': \'#0F0F1A\',\n                    \'--footer-text-color\': \'#C0C0E0\',\n                    \'--glass-bg\': \'rgba(26, 10, 42, 0.7)\',\n                    \'--glass-border\': \'rgba(160, 160, 192, 0.3)\',\n                    \'--fact-text-shadow\': \'0 0 15px rgba(224, 224, 255, 0.8)\',\n                    \'--title-color\': \'#FFFFFF\',\n                    \'--title-shadow\': \'0 0 25px rgba(255, 255, 255, 0.9)\',\n                    \'--main-action-btn\': \'#8A2BE2\', /* Blue Violet */\n                    \'--main-action-btn-hover\': \'#6A0DAD\', /* Darker Blue Violet */\n                    \'--explore-glow-color\': \'#DA70D6\', /* Orchid */\n                    \'--explore-text-initial\': \'rgba(224, 224, 255, 0.4)\',\n                    \'--explore-text-active\': \'#E0E0FF\',\n                    \'--fact-card-bg\': \'rgba(0, 0, 0, 0.8)\',\n                    \'--fact-card-border\': \'rgba(218, 112, 214, 0.7)\',\n                    \'--fact-of-day-glow\': \'0 0 25px rgba(218, 112, 214, 0.9)\',\n                    \'--stellar-scan-bg-primary\': \'#000000\',\n                    \'--stellar-scan-bg-secondary\': \'#000005\',\n                    \'--stellar-scan-indicator\': \'#00FFFF\', /* Cyan */\n                    \'--stellar-scan-text\': \'#00FFFF\' /* Cyan */\n                }\n            },\n            {\n                title: "The Observable Universe: Vast and Mysterious",\n                main: "The observable universe is estimated to be about 93 billion light-years in diameter, containing billions of galaxies.",\n                detail: "Despite its immense size, this is only the portion of the universe from which light has had time to reach us since the Big Bang. The true size of the universe remains unknown.",\n                anomaly: "Anomaly Detected: The 'Cold Spot' in the CMB is an unusually large and cold region, potentially indicating a massive void or even evidence of a parallel universe.",\n                theme: {\n                    '--bg-color-primary': '#000020',\n                    '--bg-color-secondary': '#000035',\n                    '--text-color': '#CCEEFF',\n                    '--footer-bg': '#00001A',\n                    '--footer-text-color': '#AACCFF',\n                    '--glass-bg': 'rgba(0, 0, 50, 0.7)',\n                    '--glass-border': 'rgba(153, 187, 221, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(204, 238, 255, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#4169E1', /* Royal Blue */
                    '--main-action-btn-hover': '#2A4BCC', /* Darker Royal Blue */
                    '--explore-glow-color': '#87CEFA', /* Light Sky Blue */
                    '--explore-text-initial': 'rgba(204, 238, 255, 0.4)',
                    '--explore-text-active': '#CCEEFF',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(135, 206, 250, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(135, 206, 250, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#87CEFA', /* Light Sky Blue */
                    '--stellar-scan-text': '#87CEFA' /* Light Sky Blue */
                }
            },
            {\n                title: "Black Holes: Gravity\'s Ultimate Trap",\n                main: "Black holes are regions of spacetime where gravity is so strong that nothing, not even light, can escape.",\n                detail: "They are formed from the remnants of massive stars and come in various sizes, from stellar-mass black holes to supermassive black holes found at the centers of galaxies.",\n                anomaly: "Anomaly Detected: The 'information paradox' suggests that information about matter falling into a black hole might be lost forever, challenging fundamental laws of physics.",\n                theme: {\n                    '--bg-color-primary': '#000000',\n                    '--bg-color-secondary': '#100010',\n                    '--text-color': '#FFD700', /* Gold */
                    '--footer-bg': '#000000',\n                    '--footer-text-color': '#FFEC8B', /* Light Gold */
                    '--glass-bg': 'rgba(16, 0, 16, 0.7)',
                    '--glass-border': 'rgba(184, 134, 11, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(255, 215, 0, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#FF4500', /* Orange Red */
                    '--main-action-btn-hover': '#CC3700', /* Darker Orange Red */
                    '--explore-glow-color': '#FFD700', /* Gold */
                    '--explore-text-initial': 'rgba(255, 215, 0, 0.4)',
                    '--explore-text-active': '#FFD700',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(255, 215, 0, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(255, 215, 0, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#FFD700', /* Gold */
                    '--stellar-scan-text': '#FFD700' /* Gold */
                }
            },\n            {\n                title: "Exoplanets: Worlds Beyond Our Solar System",\n                main: "Thousands of exoplanets have been discovered, orbiting stars other than our Sun, with many potentially habitable.",\n                detail: "These distant worlds offer a glimpse into the diversity of planetary systems in our galaxy and fuel the search for extraterrestrial life.",\n                anomaly: "Anomaly Detected: Some exoplanets, known as 'rogue planets', wander through space without orbiting any star, making them incredibly difficult to detect.",\n                theme: {\n                    '--bg-color-primary': '#001A00',\n                    '--bg-color-secondary': '#002A00',\n                    '--text-color': '#CCFFCC',\n                    '--footer-bg': '#001000',\n                    '--footer-text-color': '#AADDAA',\n                    '--glass-bg': 'rgba(0, 42, 0, 0.7)',
                    '--glass-border': 'rgba(153, 204, 153, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(204, 255, 204, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#32CD32', /* Lime Green */
                    '--main-action-btn-hover': '#228B22', /* Forest Green */
                    '--explore-glow-color': '#7CFC00', /* Lawn Green */
                    '--explore-text-initial': 'rgba(204, 255, 204, 0.4)',
                    '--explore-text-active': '#CCFFCC',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(124, 252, 0, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(124, 252, 0, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#7CFC00', /* Lawn Green */
                    '--stellar-scan-text': '#7CFC00' /* Lawn Green */
                }
            },\n            {\n                title: "The Cosmic Microwave Background: Echo of the Big Bang",\n                main: "The Cosmic Microwave Background (CMB) is faint radiation filling all space, a remnant heat from the Big Bang.",\n                detail: "Discovered in 1964, the CMB provides crucial evidence for the Big Bang theory and offers a snapshot of the early universe when it was only about 380,000 years old.",\n                anomaly: "Anomaly Detected: The 'Axis of Evil' is an observed alignment of certain CMB features that some theories suggest could point to a connection with other universes or a preferred direction in space.",\n                theme: {\n                    '--bg-color-primary': '#201000',\n                    '--bg-color-secondary': '#351A00',\n                    '--text-color': '#FFFACD', /* Lemon Chiffon */
                    '--footer-bg': '#1A0D00',\n                    '--footer-text-color': '#FFDAB9', /* Peach Puff */
                    '--glass-bg': 'rgba(50, 26, 0, 0.7)',
                    '--glass-border': 'rgba(210, 180, 140, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(255, 250, 205, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#D2691E', /* Chocolate */
                    '--main-action-btn-hover': '#A0522D', /* Sienna */
                    '--explore-glow-color': '#F4A460', /* Sandy Brown */
                    '--explore-text-initial': 'rgba(255, 250, 205, 0.4)',
                    '--explore-text-active': '#FFFACD',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(244, 164, 96, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(244, 164, 96, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#F4A460', /* Sandy Brown */
                    '--stellar-scan-text': '#F4A460' /* Sandy Brown */
                }
            },\n            {\n                title: "Cosmic Riddle: The Ghostly Traveler",\n                riddle: "I am a traveler, without a home, drifting through the cosmos, forever alone. I don\'t orbit a star, yet I\'m a world in my own right. What am I?",\n                answer: "Rogue Planet",\n                main: "Rogue planets are celestial objects with planetary mass that do not orbit a star and instead drift through space as independent entities.",\n                detail: "These mysterious worlds are incredibly difficult to detect, as they do not emit their own light and are not illuminated by a nearby star. Their existence challenges our traditional understanding of planetary systems.",\n                anomaly: "Anomaly Detected: The sheer number of rogue planets could vastly outnumber stars in our galaxy, making interstellar travel potentially more hazardous and offering new possibilities for life in unexpected places.",\n                theme: {\n                    '--bg-color-primary': '#050515',\n                    '--bg-color-secondary': '#101025',\n                    '--text-color': '#E0FFFF', /* Light Cyan */
                    '--footer-bg': '#08081A',\n                    '--footer-text-color': '#B0E0E6', /* Powder Blue */
                    '--glass-bg': 'rgba(16, 16, 37, 0.7)',
                    '--glass-border': 'rgba(176, 224, 230, 0.3)',
                    '--fact-text-shadow': '0 0 15px rgba(224, 255, 255, 0.8)',
                    '--title-color': '#FFFFFF',
                    '--title-shadow': '0 0 25px rgba(255, 255, 255, 0.9)',
                    '--main-action-btn': '#4682B4', /* Steel Blue */
                    '--main-action-btn-hover': '#36648B', /* Darker Steel Blue */
                    '--explore-glow-color': '#ADD8E6', /* Light Blue */
                    '--explore-text-initial': 'rgba(224, 255, 255, 0.4)',
                    '--explore-text-active': '#E0FFFF',
                    '--fact-card-bg': 'rgba(0, 0, 0, 0.8)',
                    '--fact-card-border': 'rgba(173, 216, 230, 0.7)',
                    '--fact-of-day-glow': '0 0 25px rgba(173, 216, 230, 0.9)',
                    '--stellar-scan-bg-primary': '#000000',
                    '--stellar-scan-bg-secondary': '#000005',
                    '--stellar-scan-indicator': '#ADD8E6', /* Light Blue */
                    '--stellar-scan-text': '#ADD8E6' /* Light Blue */
                }
            }
        ];

        let currentFactIndex = 1; // Set to Neutron Stars fact initially
        let factHistory = []; // To store indices of viewed facts

        function applyTheme(theme) {
            for (const [property, value] of Object.entries(theme)) {
                root.style.setProperty(property, value);
            }
        }

        function displayFact(index, fromHistory = false) {
            const fact = facts[index];
            applyTheme(fact.theme);
            siteTitle.textContent = "Cosmic Wonders Explorer";
            factTitle.textContent = fact.title;
            mainFact.textContent = fact.main;
            factDetail.textContent = fact.detail;

            // Reset riddle section
            riddleSection.style.display = 'none';
            riddleInput.value = '';
            riddleFeedback.textContent = '';
            deepDiveButton.style.display = 'inline-block';
            anomalyDetectorButton.style.display = 'inline-block';
            revealFactButton.style.display = 'none'; // Hide reveal button by default

            if (fact.riddle) {
                riddleSection.style.display = 'flex';
                riddleText.textContent = fact.riddle;
                mainFact.style.display = 'none'; // Hide main fact until riddle is solved
                factDetail.style.display = 'none'; // Hide detail
                deepDiveButton.style.display = 'none';
                anomalyDetectorButton.style.display = 'none';
                solveRiddleButton.disabled = false;
                riddleInput.disabled = false;
                solveRiddleButton.textContent = 'Solve Riddle';
            } else {
                mainFact.style.display = 'block'; // Immediately show main fact
                factDetail.style.display = 'block'; // Immediately show detail
                mainFact.classList.add('revealed');
                factDetail.classList.add('revealed');
                revealFactButton.style.display = 'none'; // Hide reveal button
                deepDiveButton.textContent = 'Cosmic Alignment Scan';
                deepDiveButton.disabled = false;
            }

            body.classList.remove('stellar-scanned');
            stellarScanContainer.classList.remove('active');
            stellarIndicator.style.height = '0%';
            stellarStatus.textContent = 'Scanning...';

            if (!fromHistory) {
                addFactToHistory(index);
            }
            updateCosmicEchoes();
        }

        function revealFact() {
            mainFact.style.display = 'block';
            factDetail.style.display = 'block';
            mainFact.classList.add('revealed');
            factDetail.classList.add('revealed');
            revealFactButton.style.display = 'none';
        }

        function initiateQuantumStream() {
            quantumStreamOverlay.classList.add('active');
            quantumStreamText.textContent = ''; // Clear previous text
            const messages = [
                "Initiating Quantum Data Stream...",
                "Accessing interdimensional archives...",
                "Decoding cosmic frequencies...",
                "New discovery incoming!"
            ];
            let messageIndex = 0;

            function typeMessage() {
                if (messageIndex < messages.length) {
                    quantumStreamText.style.width = '0%'; // Reset for typing animation
                    quantumStreamText.textContent = messages[messageIndex];
                    quantumStreamText.style.animation = 'typing 2s steps(20, end) forwards, blink-caret 0.75s step-end infinite';
                    messageIndex++;
                    setTimeout(typeMessage, 3000); // Wait for message to type, then next message
                } else {
                    setTimeout(() => {
                        quantumStreamOverlay.classList.remove('active');
                        displayRandomFact();
                    }, 1000); // Short delay before revealing fact
                }
            }
            typeMessage();
        }

        function displayRandomFact() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * facts.length);
            } while (newIndex === currentFactIndex);
            currentFactIndex = newIndex;
            displayFact(currentFactIndex);
        }

        function activateDeepDive() {
            deepDiveButton.disabled = true;
            const currentFact = facts[currentFactIndex];

            cosmicScanOverlay.classList.add('active');
            scanDetailOverlayText.textContent = currentFact.detail;

            setTimeout(() => {
                cosmicScanOverlay.classList.remove('active');
                deepDiveButton.textContent = 'Scan Complete!';
                deepDiveButton.disabled = true;
            }, 4000); // Overlay active for 4 seconds
        }

        function activateAnomalyDetector() {
            const currentFact = facts[currentFactIndex];
            anomalyContent.textContent = currentFact.anomaly;
            anomalyOverlay.classList.add('active');

            setTimeout(() => {
                anomalyOverlay.classList.remove('active');
            }, 6000); // Anomaly message disappears after 6 seconds
        }

        function solveRiddle() {
            const currentFact = facts[currentFactIndex];
            const userAnswer = riddleInput.value.trim();

            if (userAnswer.toLowerCase() === currentFact.answer.toLowerCase()) {
                riddleFeedback.style.color = 'lightgreen';
                riddleFeedback.textContent = 'Riddle Solved! Fact Revealed!';
                mainFact.style.display = 'block';
                factDetail.style.display = 'block';
                mainFact.classList.add('revealed');
                factDetail.classList.add('revealed');
                riddleInput.disabled = true;
                solveRiddleButton.disabled = true;
                solveRiddleButton.textContent = 'Solved!';
                deepDiveButton.style.display = 'inline-block';
                anomalyDetectorButton.style.display = 'inline-block';
            } else {
                riddleFeedback.style.color = 'red';
                riddleFeedback.textContent = 'Incorrect. Try again, explorer!';
            }
        }

        // Cosmic Echoes functions
        function addFactToHistory(index) {
            // Remove if already in history to move to front
            factHistory = factHistory.filter(item => item !== index);
            factHistory.unshift(index); // Add to the beginning
            if (factHistory.length > 7) { // Limit history to 7 facts
                factHistory.pop();
            }
        }

        function updateCosmicEchoes() {
            cosmicEchoesContainer.innerHTML = ''; // Clear existing echoes
            factHistory.forEach(index => {
                const fact = facts[index];
                const echo = document.createElement('div');
                echo.classList.add('cosmic-echo');
                if (index === currentFactIndex) {
                    echo.classList.add('active');
                }
                echo.textContent = fact.title.split(':')[0].trim(); // Display only the main title part
                echo.onclick = () => {
                    currentFactIndex = index;
                    displayFact(index, true); // Indicate it's from history
                };
                cosmicEchoesContainer.appendChild(echo);
            });
        }

        // Initial fact display
        displayFact(currentFactIndex);

        // Stardust Particle Effect
        function createParticle(className, animationDelay) {
            const particle = document.createElement('div');
            particle.classList.add(className);
            document.body.appendChild(particle);

            const size = Math.random() * 10 + 5; // 5 to 15px
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}vw`;
            particle.style.animationDelay = `${animationDelay}s`;
            particle.style.animationDuration = `${Math.random() * 20 + 15}s`; // 15-35s

            particle.addEventListener('animationend', () => {
                particle.remove();
            });
        }

        setInterval(() => {
            createParticle('stardust-particle', 0);
        }, 500);

        // Cosmic Sparkle on fact card hover
        factCard.addEventListener('mousemove', (e) => {
            if (Math.random() < 0.1) {
                const sparkle = document.createElement('div');
                sparkle.classList.add('cosmic-sparkle');
                factCard.appendChild(sparkle);

                const rect = factCard.getBoundingClientRect();
                sparkle.style.left = `${e.clientX - rect.left - 5}px`;
                sparkle.style.top = `${e.clientY - rect.top - 5}px`;

                const size = Math.random() * 8 + 2;
                sparkle.style.width = `${size}px`;
                sparkle.style.height = `${size}px`;

                sparkle.addEventListener('animationend', () => {
                    sparkle.remove();
                });
            }
        });

        // Footer update time
        function updateFooterTime() {
            const footer = document.querySelector('footer');
            const now = new Date();
            footer.innerHTML = `&copy; ${now.getFullYear()} Cosmic Wonders Explorer. Last updated: ${now.toLocaleString()}`;
        }
        updateFooterTime();
        setInterval(updateFooterTime, 60000);
    </script>
    <footer>
        &copy; 2025 Cosmic Wonders Explorer. Last updated: <!-- Time will be inserted by JavaScript -->
    </footer>
</body>
</html>