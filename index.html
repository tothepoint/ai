<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interesting Facts</title>
    <style>
        body {
            background-color: hsl(240, 30%, 15%); /* Space theme background */
            color: hsl(60, 80%, 90%); /* Space theme text */
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            transition: background-color 0.5s ease;
        }
        .container {
            max-width: 900px;
            width: 100%;
            margin-bottom: 20px;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
            backdrop-filter: blur( 4px );
            -webkit-backdrop-filter: blur( 4px );
            border: 1px solid rgba( 255, 255, 255, 0.18 );
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        h1#main-title {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            color: hsl(0, 0%, 100%);
        }
        #fact-display-area, #quiz-area, #challenge-area {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            width: 90%;
            max-width: 700px;
        }
        p {
            font-size: 1.8rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        p:hover {
            transform: scale(1.02);
            color: hsl(60, 100%, 80%);
        }
        #main-fact, #quiz-fact, #challenge-fact {
            animation: fadeInScale 1s ease-out forwards;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes slideInFromBottom {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 0.9; }
        }
        #more-info {
            font-size: 1.3rem;
            color: hsl(0, 0%, 85%);
            margin-top: 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-out, opacity 0.7s ease-out, transform 0.7s ease-out;
            opacity: 0;
            transform: translateY(-10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 15px;
        }
        #more-info.show-more-info {
            max-height: 200px;
            opacity: 1;
            transform: translateY(0);
        }
        .fact-actions, .social-actions, .challenge-actions {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        button {
            background-color: hsl(210, 40%, 50%);
            color: #FFFFFF;
            border: none;
            padding: 12px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background-color: hsl(210, 50%, 60%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .main-action-btn {
            background-color: hsl(160, 60%, 40%);
            font-size: 1.3rem;
            padding: 15px 30px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        .main-action-btn:hover {
            background-color: hsl(160, 70%, 50%);
        }
        #footer-info {
            font-size: 1.2rem;
            color: hsl(60, 80%, 90%); /* Space theme text for footer */
            background-color: hsl(240, 20%, 10%); /* Space theme footer background */
            padding: 15px 30px;
            border-radius: 10px;
            opacity: 0.9;
            margin-top: 30px;
            animation: slideInFromBottom 0.7s ease-out forwards;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.2);
        }
        #fact-of-the-day {
            font-size: 1.1rem;
            color: hsl(60, 70%, 80%);
            margin-top: 15px;
            margin-bottom: 15px;
        }

        /* Quiz Specific Styles */
        #quiz-area h2, #challenge-area h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: hsl(60, 100%, 85%);
        }
        #quiz-fact, #challenge-fact {
            font-size: 1.6rem;
            margin-bottom: 2rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #quiz-options, #challenge-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .quiz-option-btn, .challenge-option-btn {
            background-color: hsl(200, 30%, 30%);
            color: #FFFFFF;
            padding: 12px 25px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            min-width: 120px;
        }
        .quiz-option-btn:hover, .challenge-option-btn:hover {
            background-color: hsl(200, 40%, 40%);
            transform: translateY(-2px);
        }
        .quiz-option-btn.correct, .challenge-option-btn.correct {
            background-color: hsl(120, 50%, 40%);
        }
        .quiz-option-btn.incorrect, .challenge-option-btn.incorrect {
            background-color: hsl(0, 50%, 40%);
        }
        #quiz-feedback, #challenge-feedback {
            font-size: 1.5rem;
            font-weight: bold;
            min-height: 30px;
        }

        /* Challenge Specific Styles */
        #challenge-timer {
            font-size: 2rem;
            font-weight: bold;
            color: hsl(0, 100%, 70%);
            margin-bottom: 1rem;
        }

        /* Collapsible History */
        .collapsible-section {
            margin-top: 30px;
            width: 90%;
            max-width: 700px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transition: max-height 0.7s ease-out;
            max-height: 80px;
        }
        .collapsible-section.expanded {
            max-height: 400px;
        }
        #history-toggle {
            cursor: pointer;
            font-size: 1.5rem;
            color: hsl(0, 0%, 90%);
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #history-toggle .toggle-icon {
            margin-left: 10px;
            transition: transform 0.3s ease;
        }
        .collapsible-section.expanded #history-toggle .toggle-icon {
            transform: rotate(180deg);
        }
        #history-list {
            list-style: none;
            padding: 0;
            margin: 0;
            text-align: left;
            color: hsl(0, 0%, 80%);
            font-size: 1.1rem;
        }
        #history-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        #history-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="main-title">Interesting Facts</h1>
        <div id="fact-display-area">
            <p id="main-fact">The Milky Way galaxy is thought to smell of rum, raspberries, and booze.</p>
            <p id="more-info">This unique scent is attributed to ethyl formate, a chemical found in rum and raspberries, detected in the Sagittarius B2 cloud near the galaxy's center.</p>
            <div class="fact-actions">
                <button id="new-fact-btn">New Fact</button>
                <button id="toggle-more-info-btn">Show More Info</button>
                <button id="read-aloud-btn">Read Aloud</button>
            </div>
            <div class="social-actions">
                <button id="copy-fact-btn">Copy</button>
                <button id="share-twitter-btn">Share</button>
                <button id="fact-source-btn">Source</button>
                <button id="like-fact-btn">Like</button>
            </div>
        </div>

        <div id="quiz-area" style="display: none;">
            <h2>Fact Quiz!</h2>
            <p id="quiz-fact"></p>
            <div id="quiz-options"></div>
            <p id="quiz-feedback"></p>
            <button id="next-quiz-btn" style="display: none;">Next Question</button>
        </div>

        <div id="challenge-area" style="display: none;">
            <h2>Fact Challenge!</h2>
            <p id="challenge-fact"></p>
            <div id="challenge-timer">Time: 10s</div>
            <div id="challenge-options"></div>
            <p id="challenge-feedback"></p>
            <div class="challenge-actions">
                <button id="next-challenge-btn" style="display: none;">Next Challenge</button>
                <button id="restart-challenge-btn" style="display: none;">Restart Challenge</button>
            </div>
        </div>

        <div class="fact-actions">
            <button id="toggle-quiz-btn" class="main-action-btn">Start Fact Quiz</button>
            <button id="toggle-challenge-btn" class="main-action-btn">Start Fact Challenge</button>
        </div>
        <div id="fact-of-the-day"></div>
    </div>
    
    <div id="footer-info">Explore the amazing world of Space!</div>

    <div id="fact-history" class="collapsible-section">
        <h3 id="history-toggle">Fact History <span class="toggle-icon">▼</span></h3>
        <ul id="history-list"></ul>
    </div>
    
    <script>
        const facts = [
            { main: "🌳 Trees can communicate with each other, and forests can even create their own rain through a process called the Biotic Pump Theory.", more: "This communication happens through a network of fungi in their roots, and the Biotic Pump Theory suggests that forests can influence atmospheric pressure and humidity to generate rainfall.", theme: "Nature" },
            { main: "In the vacuum of space, two pieces of the same metal will permanently bond if they touch.", more: "This phenomenon is known as 'cold welding' and occurs because there's no atmosphere to create an oxide layer, allowing the atoms to fuse.", theme: "Space" },
            { main: "🦥 Sloths can hold their breath longer than dolphins.", more: "Sloths can slow their heart rate and hold their breath underwater for up to 40 minutes, which is longer than dolphins can.", theme: "Animals" },
            { main: "🌌 The Universe's average color is called 'Cosmic Latte'.", more: "This color was determined by a team of astronomers in 2002, averaging the light from over 200,000 galaxies.", theme: "Space" },
            { main: "🌌 A day on Venus is longer than its year.", more: "It takes about 243 Earth days to complete one spin on its axis, but only 225 Earth days to orbit the Sun.", theme: "Space" },
            { main: "🥛 Hippopotamus milk is pink.", more: "This unique color is due to two distinct acids, hipposudoric acid and norhipposudoric acid, which act as natural pigments and also have antibiotic properties.", theme: "Animals" },
            { main: "🌊 The Great Barrier Reef is the largest living structure on Earth and can be seen from space.", more: "It is composed of over 3,000 individual reefs and 900 islands stretching for over 2,300 kilometers.", theme: "Ocean" },
            { main: "🌳 A single oak tree can produce 10 million acorns in its lifetime.", more: "However, only about 1 in 10,000 acorns will grow into a new oak tree.", theme: "Nature" },
            { main: "🦋 The Monarch butterfly migrates up to 3,000 miles from Canada and the U.S. to Mexico.", more: "This incredible journey is undertaken by several generations of butterflies, with no single butterfly completing the entire round trip.", theme: "Animals" },
            { main: "🧠 The human brain weighs about 3 pounds but uses 20% of the body's oxygen and calories.", more: "It contains approximately 86 billion neurons, more than the number of stars in our galaxy.", theme: "Human Body" },
            { main: "💡 The average person will spend 6 months of their life waiting for red lights to turn green.", more: "This is based on an average commute and daily activities involving traffic lights.", theme: "Everyday Life" },
            { main: "🌳 There are more trees on Earth than stars in the Milky Way galaxy.", more: "Scientists estimate there are about 3 trillion trees on Earth, while the Milky Way is estimated to contain 100-400 billion stars.", theme: "Nature" },
            { main: "🌌 The Milky Way galaxy is thought to smell of rum, raspberries, and booze.", more: "This unique scent is attributed to ethyl formate, a chemical found in rum and raspberries, detected in the Sagittarius B2 cloud near the galaxy's center.", theme: "Space" }
        ];

        let currentFactIndex;
        let quizScore = 0;
        let currentQuizFact = null;
        let challengeScore = 0;
        let challengeTimer;
        let timeLeft = 10;
        let currentChallengeFact = null;

        const mainTitleElement = document.getElementById('main-title');
        const factDisplayArea = document.getElementById('fact-display-area');
        const mainFactElement = document.getElementById('main-fact');
        const moreInfoElement = document.getElementById('more-info');
        const copyFactBtn = document.getElementById('copy-fact-btn');
        const shareTwitterBtn = document.getElementById('share-twitter-btn');
        const newFactBtn = document.getElementById('new-fact-btn');
        const toggleMoreInfoBtn = document.getElementById('toggle-more-info-btn');
        const factSourceBtn = document.getElementById('fact-source-btn');
        const readAloudBtn = document.getElementById('read-aloud-btn');
        const likeFactBtn = document.getElementById('like-fact-btn');
        const bodyElement = document.body;
        const footerInfoElement = document.getElementById('footer-info');
        const factOfTheDayElement = document.getElementById('fact-of-the-day');

        const quizArea = document.getElementById('quiz-area');
        const quizFactElement = document.getElementById('quiz-fact');
        const quizOptionsElement = document.getElementById('quiz-options');
        const quizFeedbackElement = document.getElementById('quiz-feedback');
        const nextQuizBtn = document.getElementById('next-quiz-btn');
        const toggleQuizBtn = document.getElementById('toggle-quiz-btn');

        const challengeArea = document.getElementById('challenge-area');
        const challengeFactElement = document.getElementById('challenge-fact');
        const challengeTimerElement = document.getElementById('challenge-timer');
        const challengeOptionsElement = document.getElementById('challenge-options');
        const challengeFeedbackElement = document.getElementById('challenge-feedback');
        const nextChallengeBtn = document.getElementById('next-challenge-btn');
        const restartChallengeBtn = document.getElementById('restart-challenge-btn');
        const toggleChallengeBtn = document.getElementById('toggle-challenge-btn');

        const factHistorySection = document.getElementById('fact-history');
        const historyToggle = document.getElementById('history-toggle');
        const historyListElement = document.getElementById('history-list');

        const today = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        factOfTheDayElement.textContent = `Fact of the Day: ${today.toLocaleDateString(undefined, options)}`;

        const themeColors = {
            "Space": {
                background: 'hsl(240, 30%, 15%)',
                text: 'hsl(60, 80%, 90%)',
                footerBackground: 'hsl(240, 20%, 10%)'
            },
            "Nature": {
                background: 'hsl(120, 30%, 20%)',
                text: 'hsl(60, 80%, 90%)',
                footerBackground: 'hsl(120, 20%, 15%)'
            },
            "Animals": {
                background: 'hsl(30, 40%, 25%)',
                text: 'hsl(0, 0%, 95%)',
                footerBackground: 'hsl(30, 30%, 20%)'
            },
            "Ocean": {
                background: 'hsl(200, 50%, 20%)',
                text: 'hsl(180, 70%, 90%)',
                footerBackground: 'hsl(200, 40%, 15%)'
            },
            "Human Body": {
                background: 'hsl(210, 10%, 25%)',
                text: 'hsl(0, 0%, 95%)',
                footerBackground: 'hsl(210, 10%, 15%)'
            },
            "Everyday Life": {
                background: 'hsl(40, 20%, 30%)',
                text: 'hsl(0, 0%, 95%)',
                footerBackground: 'hsl(40, 15%, 25%)'
            }
        };

        function applyThemeColors(theme) {
            if (themeColors[theme]) {
                bodyElement.style.backgroundColor = themeColors[theme].background;
                bodyElement.style.color = themeColors[theme].text;
                footerInfoElement.style.backgroundColor = themeColors[theme].footerBackground;
                footerInfoElement.style.color = themeColors[theme].text;
            }
        }

        function displayFact(index) {
            mainFactElement.style.animation = 'none';
            void mainFactElement.offsetWidth;
            mainFactElement.style.animation = 'fadeInScale 1s ease-out forwards';

            mainFactElement.textContent = facts[index].main;
            moreInfoElement.textContent = facts[index].more;
            moreInfoElement.classList.remove('show-more-info');
            toggleMoreInfoBtn.textContent = 'Show More Info';

            footerInfoElement.textContent = `Explore the amazing world of ${facts[index].theme}!`;
            applyThemeColors(facts[index].theme);
            updateFactHistory(facts[index].main);
        }

        // Fact Display Event Listeners
        mainFactElement.addEventListener('click', () => {
            moreInfoElement.classList.toggle('show-more-info');
            toggleMoreInfoBtn.textContent = moreInfoElement.classList.contains('show-more-info') ? 'Hide More Info' : 'Show More Info';
        });

        newFactBtn.addEventListener('click', () => {
            currentFactIndex = Math.floor(Math.random() * facts.length);
            displayFact(currentFactIndex);
        });

        copyFactBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(mainFactElement.textContent).then(() => {
                alert('Fact copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy fact: ', err);
            });
        });

        shareTwitterBtn.addEventListener('click', () => {
            const text = encodeURIComponent(mainFactElement.textContent + " #InterestingFacts #FactOfTheDay");
            window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
        });

        toggleMoreInfoBtn.addEventListener('click', () => {
            moreInfoElement.classList.toggle('show-more-info');
            toggleMoreInfoBtn.textContent = moreInfoElement.classList.contains('show-more-info') ? 'Hide More Info' : 'Show More Info';
        });

        factSourceBtn.addEventListener('click', () => {
            const factQuery = encodeURIComponent(mainFactElement.textContent.replace(/^[^\s]+\s/, ''));
            window.open(`https://www.google.com/search?q=${factQuery}`, '_blank');
        });

        readAloudBtn.addEventListener('click', () => {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(mainFactElement.textContent + ". " + moreInfoElement.textContent);
                speechSynthesis.speak(utterance);
            } else {
                alert("Sorry, your browser doesn't support text to speech.");
            }
        });

        likeFactBtn.addEventListener('click', () => {
            alert('You liked this fact!');
        });

        // Fact History Logic
        const factHistory = [];

        function updateFactHistory(fact) {
            if (factHistory.length === 0 || factHistory[factHistory.length - 1] !== fact) {
                factHistory.push(fact);
                if (factHistory.length > 5) {
                    factHistory.shift();
                }
            }
            renderFactHistory();
        }

        function renderFactHistory() {
            historyListElement.innerHTML = '';
            factHistory.forEach((fact, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${index + 1}. ${fact}`;
                historyListElement.appendChild(listItem);
            });
        }

        historyToggle.addEventListener('click', () => {
            factHistorySection.classList.toggle('expanded');
        });

        // Quiz Logic
        const availableThemes = Object.keys(themeColors);

        toggleQuizBtn.addEventListener('click', () => {
            if (factDisplayArea.style.display !== 'none' || challengeArea.style.display !== 'none') {
                factDisplayArea.style.display = 'none';
                challengeArea.style.display = 'none';
                quizArea.style.display = 'block';
                toggleQuizBtn.textContent = 'Back to Facts';
                toggleChallengeBtn.style.display = 'none';
                mainTitleElement.textContent = 'Fact Quiz!';
                startQuiz();
            } else {
                quizArea.style.display = 'none';
                factDisplayArea.style.display = 'block';
                toggleQuizBtn.textContent = 'Start Fact Quiz';
                toggleChallengeBtn.style.display = 'inline-block';
                mainTitleElement.textContent = 'Interesting Facts';
                quizScore = 0;
                quizFeedbackElement.textContent = '';
                nextQuizBtn.style.display = 'none';
            }
        });

        function startQuiz() {
            quizScore = 0;
            quizFeedbackElement.textContent = '';
            nextQuizBtn.style.display = 'none';
            displayQuizQuestion();
        }

        function displayQuizQuestion() {
            quizOptionsElement.innerHTML = '';
            quizFeedbackElement.textContent = '';
            nextQuizBtn.style.display = 'none';

            const randomFactIndex = Math.floor(Math.random() * facts.length);
            currentQuizFact = facts[randomFactIndex];
            quizFactElement.textContent = currentQuizFact.main;

            let options = [currentQuizFact.theme];
            while (options.length < 4) {
                const randomTheme = availableThemes[Math.floor(Math.random() * availableThemes.length)];
                if (!options.includes(randomTheme)) {
                    options.push(randomTheme);
                }
            }
            options.sort(() => Math.random() - 0.5);

            options.forEach(theme => {
                const button = document.createElement('button');
                button.textContent = theme;
                button.classList.add('quiz-option-btn');
                button.addEventListener('click', () => checkAnswer(button, theme));
                quizOptionsElement.appendChild(button);
            });
        }

        function checkAnswer(selectedButton, selectedTheme) {
            Array.from(quizOptionsElement.children).forEach(button => {
                button.disabled = true;
                if (button.textContent === currentQuizFact.theme) {
                    button.classList.add('correct');
                } else {
                    button.classList.add('incorrect');
                }
            });

            if (selectedTheme === currentQuizFact.theme) {
                quizFeedbackElement.textContent = 'Correct! 🎉';
                quizScore++;
            } else {
                quizFeedbackElement.textContent = `Incorrect. The answer was ${currentQuizFact.theme}.`;
            }
            nextQuizBtn.style.display = 'block';
        }

        nextQuizBtn.addEventListener('click', displayQuizQuestion);

        // Challenge Logic
        toggleChallengeBtn.addEventListener('click', () => {
            if (factDisplayArea.style.display !== 'none' || quizArea.style.display !== 'none') {
                factDisplayArea.style.display = 'none';
                quizArea.style.display = 'none';
                challengeArea.style.display = 'block';
                toggleChallengeBtn.textContent = 'Back to Facts';
                toggleQuizBtn.style.display = 'none';
                mainTitleElement.textContent = 'Fact Challenge!';
                startChallenge();
            } else {
                challengeArea.style.display = 'none';
                factDisplayArea.style.display = 'block';
                toggleChallengeBtn.textContent = 'Start Fact Challenge';
                toggleQuizBtn.style.display = 'inline-block';
                mainTitleElement.textContent = 'Interesting Facts';
                challengeScore = 0;
                challengeFeedbackElement.textContent = '';
                nextChallengeBtn.style.display = 'none';
                restartChallengeBtn.style.display = 'none';
                clearInterval(challengeTimer);
            }
        });

        function startChallenge() {
            challengeScore = 0;
            challengeFeedbackElement.textContent = '';
            nextChallengeBtn.style.display = 'none';
            restartChallengeBtn.style.display = 'none';
            displayChallengeQuestion();
        }

        function displayChallengeQuestion() {
            clearInterval(challengeTimer);
            timeLeft = 10;
            challengeTimerElement.textContent = `Time: ${timeLeft}s`;
            challengeOptionsElement.innerHTML = '';
            challengeFeedbackElement.textContent = '';
            nextChallengeBtn.style.display = 'none';
            restartChallengeBtn.style.display = 'none';

            const randomFactIndex = Math.floor(Math.random() * facts.length);
            currentChallengeFact = facts[randomFactIndex];
            challengeFactElement.textContent = currentChallengeFact.main;

            let options = [currentChallengeFact.theme];
            while (options.length < 4) {
                const randomTheme = availableThemes[Math.floor(Math.random() * availableThemes.length)];
                if (!options.includes(randomTheme)) {
                    options.push(randomTheme);
                }
            }
            options.sort(() => Math.random() - 0.5);

            options.forEach(theme => {
                const button = document.createElement('button');
                button.textContent = theme;
                button.classList.add('challenge-option-btn');
                button.addEventListener('click', () => checkChallengeAnswer(button, theme));
                challengeOptionsElement.appendChild(button);
            });

            challengeTimer = setInterval(updateChallengeTimer, 1000);
        }

        function updateChallengeTimer() {
            timeLeft--;
            challengeTimerElement.textContent = `Time: ${timeLeft}s`;
            if (timeLeft <= 0) {
                clearInterval(challengeTimer);
                challengeFeedbackElement.textContent = `Time's up! The answer was ${currentChallengeFact.theme}.`;
                Array.from(challengeOptionsElement.children).forEach(button => {
                    button.disabled = true;
                    if (button.textContent === currentChallengeFact.theme) {
                        button.classList.add('correct');
                    }
                });
                nextChallengeBtn.style.display = 'block';
                restartChallengeBtn.style.display = 'block';
            }
        }

        function checkChallengeAnswer(selectedButton, selectedTheme) {
            clearInterval(challengeTimer);
            Array.from(challengeOptionsElement.children).forEach(button => {
                button.disabled = true;
                if (button.textContent === currentChallengeFact.theme) {
                    button.classList.add('correct');
                } else {
                    button.classList.add('incorrect');
                }
            });

            if (selectedTheme === currentChallengeFact.theme) {
                challengeFeedbackElement.textContent = 'Correct! 🎉';
                challengeScore++;
            } else {
                challengeFeedbackElement.textContent = `Incorrect. The answer was ${currentChallengeFact.theme}.`;
            }
            nextChallengeBtn.style.display = 'block';
            restartChallengeBtn.style.display = 'block';
        }

        nextChallengeBtn.addEventListener('click', displayChallengeQuestion);
        restartChallengeBtn.addEventListener('click', startChallenge);

        // Initial display
        currentFactIndex = facts.findIndex(fact => fact.main === "🌌 The Milky Way galaxy is thought to smell of rum, raspberries, and booze.");
        if (currentFactIndex === -1) {
            currentFactIndex = Math.floor(Math.random() * facts.length); // Fallback if not found
        }
        displayFact(currentFactIndex);
        updateFactHistory(facts[currentFactIndex].main);

        // Keyboard navigation for facts
        document.addEventListener('keydown', (event) => {
            if (factDisplayArea.style.display !== 'none') {
                if (event.key === 'ArrowRight') {
                    currentFactIndex = (currentFactIndex + 1) % facts.length;
                    displayFact(currentFactIndex);
                } else if (event.key === 'ArrowLeft') {
                    currentFactIndex = (currentFactIndex - 1 + facts.length) % facts.length;
                    displayFact(currentFactIndex);
                }
            }
        });
    </script>
</body>
</html>