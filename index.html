<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">Wild Wonders</title>
    <style>
        :root {
            /* Theme Colors (Incredible Animals) */
            --bg-color-primary: #224229;
            --bg-color-secondary: #3A6040;
            --text-color: #C8E6C9;
            --footer-bg: #1A301F;
            --glass-bg: rgba(34, 66, 41, 0.6);
            --glass-border: rgba(200, 230, 201, 0.3);
            --fact-text-shadow: 2px 2px 15px rgba(0,0,0,0.9);
            --title-color: #FFD700;
            --title-shadow: 4px 4px 25px rgba(0, 0, 0, 0.9);
            --button-primary: #66BB6A;
            --button-hover: #4CAF50;
            --main-action-btn: #4CAF50;
            --main-action-btn-hover: #43A047;
            --reveal-overlay-color: rgba(0, 0, 0, 0.8);
            --generic-title-color: #C8E6C9;
            --theme-indicator-color: #FFD700;
            --favorite-btn-color: #FFD700;
            --favorite-btn-hover: #B8860B;
            --star-color: #FFD700;
            --notification-bg: rgba(0, 0, 0, 0.8);
            --notification-text: #E0BBE4;
            --correct-answer-color: #3CB371;
            --incorrect-answer-color: #FF6347;
        }

        #fact-streak-display {
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 15px 30px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.5s ease;
        }

        #fact-streak-display p {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);\n            margin: 0;\n            text-shadow: 1px 1px 5px rgba(0,0,0,0.7);\n        }\n\n        #current-streak {\n            font-size: 2rem;\n            color: var(--title-color);\n            font-weight: 900;\n            text-shadow: 2px 2px 10px rgba(0,0,0,0.9);\n            transition: color 0.5s ease, transform 0.3s ease-out;\n        }\n\n        #current-streak.animate-pulse {\n            animation: pulse 0.5s ease-out;\n        }\n\n        #reset-streak-btn {\n            background-color: #6c757d; /* Grey for reset */\n            color: white;\n            padding: 10px 20px;\n            font-size: 1rem;\n            border-radius: 8px;\n            box-shadow: 0 3px 10px rgba(0,0,0,0.3);\n        }\n\n        #reset-streak-btn:hover {\n            background-color: #5a6268;\n            transform: translateY(-2px);\n            box-shadow: 0 5px 12px rgba(0,0,0,0.4);\n        }\n\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.1); }\n            100% { transform: scale(1); }\n        }\n\n        body {\n            background: linear-gradient(135deg, var(--bg-color-primary) 0%, var(--bg-color-secondary) 100%);\n            background-size: 400% 400%;\n            animation: gradientShift 15s ease infinite;\n            color: var(--text-color);\n            font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n            display: flex;\n            flex-direction: column;\n            justify-content: space-between;\n            align-items: center;\n            min-height: 100vh;\n            margin: 0;\n            text-align: center;\n            padding: 20px;\n            box-sizing: border-box;\n            transition: background 1.5s ease-in-out, color 0.8s ease;\n            overflow-x: hidden;\n            position: relative; /* For bubble animation */\n        }\n\n        @keyframes gradientShift {\n            0% { background-position: 0% 50%; }\n            50% { background-position: 100% 50%; }\n            100% { background-position: 0% 50%; }\n        }\n\n        @keyframes fadeInScale {\n            from { opacity: 0; transform: scale(0.9); }\n            to { opacity: 1; transform: scale(1); }\n        }\n\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n\n        .container {\n            max-width: 1000px;\n            width: 100%;\n            margin-bottom: 20px;\n            padding: 50px;\n            background-color: var(--glass-bg);\n            border-radius: 25px;\n            box-shadow: 0 15px 50px 0 rgba( 0, 0, 0, 0.5 );\n            backdrop-filter: blur( 12px );\n            -webkit-backdrop-filter: blur( 12px );\n            border: 1px solid var(--glass-border);\n            flex-grow: 1;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            position: relative;\n            overflow: hidden;\n        }\n        h1#main-title {\n            font-size: 4.5rem;\n            margin-bottom: 1rem;\n            text-shadow: var(--title-shadow);\n            color: var(--title-color);\n            letter-spacing: 3px;\n            font-weight: 900;\n            transition: color 1s ease;\n        }\n        #theme-indicator {\n            font-size: 1.5rem;\n            color: var(--theme-indicator-color);\n            margin-bottom: 3rem;\n            font-style: italic;\n            opacity: 0.8;\n            transition: color 1s ease;\n        }\n\n        #theme-selector-container {\n            margin-bottom: 2rem;\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n\n        #theme-selector-container label {\n            font-size: 1.3rem;\n            color: var(--text-color);\n            font-weight: 600;\n        }\n\n        #theme-select {\n            padding: 10px 20px;\n            font-size: 1.1rem;\n            border-radius: 10px;\n            border: 1px solid var(--glass-border);\n            background-color: var(--glass-bg);\n            color: var(--text-color);\n            cursor: pointer;\n            appearance: none; /* Remove default dropdown arrow */\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            background-image: url(\'data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FFD700%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-6.5%200-12.3%203.2-16.1%208.1-3.8%204.9-4.9%2011.4-3.1%2017.4l130%20140c3.8%204.9%209.6%208.1%2016.1%208.1s12.3-3.2%2016.1-8.1l130-140c1.8-6-.1-12.5-3.9-17.4z%22%2F%3E%3C%2Fsvg%3E\');\n            background-repeat: no-repeat;\n            background-position: right 15px center;\n            background-size: 1em;\n            padding-right: 40px; /* Make space for the custom arrow */\n            box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n            transition: all 0.3s ease;\n        }\n\n        #theme-select:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 20px rgba(0,0,0,0.4);\n        }\n\n        #theme-select option {\n            background-color: var(--bg-color-primary);\n            color: var(--text-color);\n        }\n\n        p {\n            font-size: 2.2rem;\n            line-height: 1.6;\n            margin-bottom: 2.5rem;\n            cursor: default;\n            transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;\n            text-shadow: var(--fact-text-shadow);\n            font-weight: 600;\n        }\n        #main-fact-container {\n            margin-top: 30px;\n            margin-bottom: 30px;\n            padding: 35px 45px;\n            background-color: var(--glass-bg);\n            border-radius: 25px;\n            box-shadow: 0 10px 35px rgba(0,0,0,0.5);\n            backdrop-filter: blur(12px);\n            -webkit-backdrop-filter: blur(12px);\n            border: 1px solid var(--glass-border);\n            cursor: default;\n            transition: all 0.5s ease, transform 0.3s ease-out;\n            position: relative;\n            overflow: hidden;\n            max-width: 900px;\n            width: 90%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            min-height: 200px;\n        }\n        #main-fact-text {\n            font-size: 2.8rem; /* Increased font size */\n            color: var(--text-color);\n            background-color: transparent;\n            padding: 15px 25px;\n            border-radius: 12px;\n            font-style: italic;\n            font-weight: 700;\n            text-shadow: var(--fact-text-shadow);\n            transition: color 1s ease, background-color 1s ease, filter 1s ease, opacity 1s ease, text-shadow 1s ease, transform 0.5s ease;\n            line-height: 1.5;\n            min-height: 100px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n            position: relative;\n            z-index: 1;\n            filter: blur(8px); /* Blurred initially */\n            opacity: 0.3; /* Less opaque initially */\n        }\n        #main-fact-text {\n            font-size: 2.8rem; /* Increased font size */\n            color: var(--text-color);\n            background-color: transparent;\n            padding: 15px 25px;\n            border-radius: 12px;\n            font-style: italic;\n            font-weight: 700;\n            text-shadow: var(--fact-text-shadow);\n            transition: color 1s ease, background-color 1s ease, text-shadow 1s ease, transform 0.5s ease;\n            line-height: 1.5;\n            min-height: 100px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n            position: relative;\n            z-index: 1;\n            opacity: 1; /* Fully opaque by default */\n            filter: blur(0px); /* Not blurred by default */\n            transform: scale(1.05); /* Slightly larger by default */\n            animation: bioluminescent-glow 1.5s infinite alternate; /* Bioluminescent glow */\n        }\n        #main-fact-container.revealed #main-fact-text.animate-in {\n            animation: fadeInScale 0.8s ease-out forwards;\n        }\n        footer {\n            margin-top: 40px;\n            padding: 20px;\n            background-color: var(--footer-bg);\n            color: var(--text-color);\n            width: 100%;\n            box-shadow: 0 -5px 20px rgba(0,0,0,0.3);\n            border-top: 1px solid rgba(255, 255, 255, 0.1);\n            font-size: 0.9rem;\n            transition: background-color 1s ease, color 0.8s ease;\n        }\n\n    </style>\n</head>\n<body>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n    <div class=\"bubble\"></div>\n\n    <div class=\"container\">\n        <h1 id=\"main-title\">Wild Wonders</h1>\n        <p id=\"theme-indicator\">The Animal Kingdom\'s Secrets</p>\n\n        <div id=\"theme-selector-container\">\n            <label for=\"theme-select\">Choose Your Journey:</label>\n            <select id=\"theme-select\">\n                <option value=\"quantum-quirks\">Quantum Quirks</option>\n                <option value=\"deep-sea-mysteries\">Deep Sea Mysteries</option>\n                <option value=\"ancient-civilizations\">Ancient Civilizations</option>\n                <option value=\"incredible-animals\" selected>Incredible Animals</option>\n                <option value=\"human-body-wonders\">Human Body Wonders</option>\n            </select>\n        </div>\n\n        <div id=\"main-fact-container\">\n            <p id=\"main-fact-text\"></p>\n        </div>\n\n        <div class=\"button-group primary-actions\">\n            <button id=\"new-fact-btn\" class=\"action-button\">New Animal Fact</button>\n            <button id=\"favorite-fact-btn\" class=\"action-button\">⭐ Favorite Fact</button>\n        </div>\n\n        <div id=\"fact-rating-container\">\n            <p>Rate this fact:</p>\n            <div class=\"star-rating\">\n                <span class=\"star\" data-value=\"1\">★</span>\n                <span class=\"star\" data-value=\"2\">★</span>\n                <span class=\"star\" data-value=\"3\">★</span>\n                <span class=\"star\" data-value=\"4\">★</span>\n                <span class=\"star\" data-value=\"5\">★</span>\n            </div>\n        </div>\n\n        <div id=\"fact-streak-display\">\n            <p>Current Streak: <span id=\"current-streak\">0</span></p>\n            <button id=\"reset-streak-btn\" class=\"action-button\">Reset Streak</button>\n        </div>\n\n        <div id=\"fact-mastery-display\">\n            <p>Fact Mastery Progress:</p>\n            <div id=\"mastery-progress-bar-container\">\n                <div id=\"mastery-progress-bar\"></div>\n            </div>\n            <p><span id=\"mastered-facts-count\">0</span> / <span id=\"total-facts-count\">0</span> Mastered</p>\n        </div>\n\n        <div class=\"button-group secondary-actions\">\n            <button id=\"toggle-did-you-know-btn\" class=\"action-button\">Did You Know?</button>\n            <button id=\"toggle-quiz-btn\" class=\"action-button\">Fact Quiz</button>\n            <button id=\"toggle-challenge-btn\" class=\"action-button\">Fact Challenge</button>\n        </div>\n\n        <div id=\"did-you-know\">\n            <h3>Did You Know?</h3>\n            <p id=\"did-you-know-text\"></p>\n        </div>\n\n        <div id=\"fact-quiz-container\">\n            <h3>Test Your Knowledge!</h3>\n            <p id=\"quiz-question\"></p>\n            <div id=\"quiz-options\"></div>\n            <p id=\"quiz-feedback\"></p>\n            <button id=\"next-quiz-btn\" class=\"action-button\">Next Question</button>\n        </div>\n\n        <div id=\"fact-challenge-container\">\n            <h3>Challenge Yourself!</h3>\n            <p id=\"challenge-question\"></p>\n            <div id=\"challenge-options\"></div>\n            <p id=\"challenge-feedback\"></p>\n            <button id=\"next-challenge-btn\" class=\"action-button\">Next Challenge</button>\n        </div>\n\n        <div class=\"button-group utility-actions\">\n            <button id=\"copy-fact-btn\" class=\"action-button\">Copy Fact</button>\n            <button id=\"share-twitter-btn\" class=\"action-button\">Share on Twitter</button>\n            <button id=\"share-whatsapp-btn\" class=\"action-button\">Share on WhatsApp</button>\n            <button id=\"toggle-favorites-btn\" class=\"action-button\">My Favorite Facts</button>\n            <button id=\"toggle-history-btn\" class=\"action-button\">Fact History</button>\n        </div>\n\n        <div id=\"favorite-facts-display\">\n            <h3>My Favorite Facts</h3>\n            <div id=\"favorite-facts-list\"></div>\n        </div>\n\n        <div id=\"fact-history-display\">\n            <h3>Fact History</h3>\n            <div id=\"fact-history-list\"></div>\n        </div>\n\n    </div>\n\n    <footer>\n        <p>Site will update at: <span id=\"update-time\"></span></p>\n    </footer>\n\n    <script>\n        const themes = {\n            \"quantum-quirks\": {\n                title: \"Quantum Quirks\",\n                indicator: \"Exploring the Subatomic Realm\",\n                fact: \"Quantum entanglement allows particles to be linked in such a way that they share the same existence, no matter how far apart they are.\",\n                didYouKnow: \"This phenomenon, famously dubbed \'spooky action at a distance\' by Albert Einstein, is a cornerstone of quantum mechanics and has profound implications for future technologies like quantum computing and cryptography.\",\n                colors: {\n                    \"--bg-color-primary\": \"#2A0A4A\",\n                    \"--bg-color-secondary\": \"#3F156B\",\n                    \"--text-color\": \"#E0BBE4\",\n                    \"--footer-bg\": \"#1F0738\",\n                    \"--glass-bg\": \"rgba(42, 10, 74, 0.6)\",\n                    \"--glass-border\": \"rgba(224, 187, 228, 0.3)\",\n                    \"--title-color\": \"#DAA520\",\n                    \"--main-action-btn\": \"#FF6347\",\n                    \"--main-action-btn-hover\": \"#E5533D\",\n                    \"--button-primary\": \"#8A2BE2\",\n                    \"--button-hover\": \"#6A0DAD\",\n                    \"--favorite-btn-color\": \"#DAA520\",\n                    \"--favorite-btn-hover\": \"#B8860B\",\n                    \"--star-color\": \"#FFD700\",\n                    \"--generic-title-color\": \"#E0BBE4\",\n                    \"--theme-indicator-color\": \"#DAA520\",\n                }\n            },\n            \"deep-sea-mysteries\": {\n                title: \"Deep Sea Wonders\",\n                indicator: \"Exploring the Ocean\'s Depths\",\n                fact: \"The Mariana Trench is deeper than Mount Everest is tall.\",\n                didYouKnow: \"The Mariana Trench is located in the western Pacific Ocean, near the Mariana Islands. It is the deepest oceanic trench on Earth and the deepest part of the Earth\'s hydrosphere.\",\n                colors: {\n                    \"--bg-color-primary\": \"#0A1F33\",\n                    \"--bg-color-secondary\": \"#0F304A\",\n                    \"--text-color\": \"#ADD8E6\",\n                    \"--footer-bg\": \"#05101A\",\n                    \"--glass-bg\": \"rgba(10, 31, 51, 0.6)\",\n                    \"--glass-border\": \"rgba(173, 216, 230, 0.3)\",\n                    \"--title-color\": \"#FFD700\",\n                    \"--main-action-btn\": \"#00CED1\",\n                    \"--main-action-btn-hover\": \"#00B0B3\",\n                    \"--button-primary\": \"#4682B4\",\n                    \"--button-hover\": \"#36648B\",\n                    \"--favorite-btn-color\": \"#FFD700\",\n                    \"--favorite-btn-hover\": \"#B8860B\",\n                    \"--star-color\": \"#FFD700\",\n                    \"--generic-title-color\": \"#ADD8E6\",\n                    \"--theme-indicator-color\": \"#FFD700\",\n                }\n            },\n            \"ancient-civilizations\": {\n                title: \"Echoes of Ancients\",\n                indicator: \"Unearthing Forgotten Worlds\",\n                fact: \"The Great Pyramid of Giza was the tallest man-made structure for over 3,800 years.\",\n                didYouKnow: \"Built for Pharaoh Khufu, its construction is estimated to have taken 20 years, using over 2.3 million stone blocks. It remained the tallest man-made structure until the Lincoln Cathedral was completed in 1311 AD.\",\n                colors: {\n                    \"--bg-color-primary\": \"#4A3C2A\",\n                    \"--bg-color-secondary\": \"#6B5B3F\",\n                    \"--text-color\": \"#F5DEB3\",\n                    \"--footer-bg\": \"#382E1F\",\n                    \"--glass-bg\": \"rgba(74, 60, 42, 0.6)\",\n                    \"--glass-border\": \"rgba(245, 222, 179, 0.3)\",\n                    \"--title-color\": \"#DAA520\",\n                    \"--main-action-btn\": \"#CD853F\",\n                    \"--main-action-btn-hover\": \"#B87333\",\n                    \"--button-primary\": \"#A0522D\",\n                    \"--button-hover\": \"#8B4513\",\n                    \"--favorite-btn-color\": \"#DAA520\",\n                    \"--favorite-btn-hover\": \"#B8860B\",\n                    \"--star-color\": \"#FFD700\",\n                    \"--generic-title-color\": \"#F5DEB3\",\n                    \"--theme-indicator-color\": \"#DAA520\",\n                }\n            },\n            \"incredible-animals\": {\n                title: \"Wild Wonders\",\n                indicator: \"The Animal Kingdom\'s Secrets\",\n                fact: \"A group of owls is called a parliament.\",\n                didYouKnow: \"This charming collective noun is thought to have originated from the perception of owls as wise and scholarly creatures, often depicted in folklore and literature as deliberating in solemn assembly.\",\n                colors: {\n                    \"--bg-color-primary\": \"#224229\",\n                    \"--bg-color-secondary\": \"#3A6040\",\n                    \"--text-color\": \"#C8E6C9\",\n                    \"--footer-bg\": \"#1A301F\",\n                    \"--glass-bg\": \"rgba(34, 66, 41, 0.6)\",\n                    \"--glass-border\": \"rgba(200, 230, 201, 0.3)\",\n                    \"--title-color\": \"#FFD700\",\n                    \"--main-action-btn\": \"#4CAF50\",\n                    \"--main-action-btn-hover\": \"#43A047\",\n                    \"--button-primary\": \"#66BB6A\",\n                    \"--button-hover\": \"#4CAF50\",\n                    \"--favorite-btn-color\": \"#FFD700\",\n                    \"--favorite-btn-hover\": \"#B8860B\",\n                    \"--star-color\": \"#FFD700\",\n                    \"--generic-title-color\": \"#C8E6C9\",\n                    \"--theme-indicator-color\": \"#FFD700\",\n                }\n            },\n            \"human-body-wonders\": {\n                title: \"Body\'s Blueprint\",\n                indicator: \"The Marvels Within Us\",\n                fact: \"Your brain uses about 20% of your body\'s oxygen and calories.\",\n                didYouKnow: \"Despite making up only about 2% of an adult\'s body weight, the brain is an incredibly energy-intensive organ, requiring a constant and significant supply of oxygen and nutrients to function optimally.\",\n                colors: {\n                    \"--bg-color-primary\": \"#4A0A0A\",\n                    \"--bg-color-secondary\": \"#6B1515\",\n                    \"--text-color\": \"#FFCCCC\",\n                    \"--footer-bg\": \"#380707\",\n                    \"--glass-bg\": \"rgba(74, 10, 10, 0.6)\",\n                    \"--glass-border\": \"rgba(255, 204, 204, 0.3)\",\n                    \"--title-color\": \"#FFD700\",\n                    \"--main-action-btn\": \"#DC143C\",\n                    \"--main-action-btn-hover\": \"#C41134\",\n                    \"--button-primary\": \"#B22222\",\n                    \"--button-hover\": \"#8B0000\",\n                    \"--favorite-btn-color\": \"#FFD700\",\n                    \"--favorite-btn-hover\": \"#B8860B\",\n                    \"--star-color\": \"#FFD700\",\n                    \"--generic-title-color\": \"#FFCCCC\",\n                    \"--theme-indicator-color\": \"#FFD700\",\n                }\n            }\n        };\n\n        let currentTheme = \"incredible-animals\"; // Set initial theme to a random one\n        let currentFact = \"\";\n        let currentDidYouKnow = \"\";\n        let factHistory = [];\n        let favoriteFacts = JSON.parse(localStorage.getItem(\'favoriteFacts\')) || [];\n        let factRatings = JSON.parse(localStorage.getItem(\'factRatings\')) || {};\n        let factStreaks = JSON.parse(localStorage.getItem(\'factStreaks\')) || {};\n        let masteredFacts = JSON.parse(localStorage.getItem(\'masteredFacts\')) || {};\n\n        const siteTitle = document.getElementById(\'site-title\');\n        const mainTitle = document.getElementById(\'main-title\');\n        const themeIndicator = document.getElementById(\'theme-indicator\');\n        const themeSelect = document.getElementById(\'theme-select\');\n        const mainFactContainer = document.getElementById(\'main-fact-container\');\n        const mainFactText = document.getElementById(\'main-fact-text\');\n        const scrambledFactDisplay = document.getElementById(\'scrambled-fact-display\');\n        const unscrambleProgressBarContainer = document.getElementById(\'unscramble-progress-bar-container\');\n        const unscrambleProgressBar = document.getElementById(\'unscramble-progress-bar\');\n        const revealOverlay = document.getElementById(\'reveal-overlay\');\n        const revealFactBtn = document.getElementById(\'reveal-fact-btn\');\n        const newFactBtn = document.getElementById(\'new-fact-btn\');\n        const favoriteFactBtn = document.getElementById(\'favorite-fact-btn\');\n        const toggleDidYouKnowBtn = document.getElementById(\'toggle-did-you-know-btn\');\n        const didYouKnowSection = document.getElementById(\'did-you-know\');\n        const didYouKnowText = document.getElementById(\'did-you-know-text\');\n        const copyFactBtn = document.getElementById(\'copy-fact-btn\');\n        const shareTwitterBtn = document.getElementById(\'share-twitter-btn\');\n        const shareWhatsappBtn = document.getElementById(\'share-whatsapp-btn\');\n        const toggleFavoritesBtn = document.getElementById(\'toggle-favorites-btn\');\n        const favoriteFactsDisplay = document.getElementById(\'favorite-facts-display\');\n        const favoriteFactsList = document.getElementById(\'favorite-facts-list\');\n        const toggleHistoryBtn = document.getElementById(\'toggle-history-btn\');\n        const factHistoryDisplay = document.getElementById(\'fact-history-display\');\n        const factHistoryList = document.getElementById(\'fact-history-list\');\n        const factRatingContainer = document.getElementById(\'fact-rating-container\');\n        const stars = document.querySelectorAll(\'.star-rating .star\');\n        const factStreakDisplay = document.getElementById(\'fact-streak-display\');\n        const currentStreakSpan = document.getElementById(\'current-streak\');\n        const resetStreakBtn = document.getElementById(\'reset-streak-btn\');\n        const toggleQuizBtn = document.getElementById(\'toggle-quiz-btn\');\n        const factQuizContainer = document.getElementById(\'fact-quiz-container\');\n        const quizQuestion = document.getElementById(\'quiz-question\');\n        const quizOptions = document.getElementById(\'quiz-options\');\n        const quizFeedback = document.getElementById(\'quiz-feedback\');\n        const nextQuizBtn = document.getElementById(\'next-quiz-btn\');\n        const factMasteryDisplay = document.getElementById(\'fact-mastery-display\');\n        const masteryProgressBar = document.getElementById(\'mastery-progress-bar\');\n        const masteredFactsCountSpan = document.getElementById(\'mastered-facts-count\');\n        const totalFactsCountSpan = document.getElementById(\'total-facts-count\');\n        const toggleChallengeBtn = document.getElementById(\'toggle-challenge-btn\');\n        const factChallengeContainer = document.getElementById(\'fact-challenge-container\');\n        const challengeQuestion = document.getElementById(\'challenge-question\');\n        const challengeOptions = document.getElementById(\'challenge-options\');\n        const challengeFeedback = document.getElementById(\'challenge-feedback\');\n        const nextChallengeBtn = document.getElementById(\'next-challenge-btn\');\n\n        let quizMode = false;\n        let challengeMode = false;\n        let currentQuizFact = null;\n        let currentChallengeFact = null;\n        let currentChallengeCorrectOption = null;\n\n        function applyTheme(themeName) {\n            const theme = themes[themeName];\n            if (!theme) return;\n\n            siteTitle.textContent = theme.title;\n            mainTitle.textContent = theme.title;\n            themeIndicator.textContent = theme.indicator;\n            currentFact = theme.fact;\n            currentDidYouKnow = theme.didYouKnow;\n            didYouKnowText.textContent = theme.didYouKnow;\n            mainFactText.textContent = currentFact; // Directly display the fact\n\n            for (const [prop, value] of Object.entries(theme.colors)) {\n                document.documentElement.style.setProperty(prop, value);\n            }\n\n            // Update the selected option in the dropdown\n            themeSelect.value = themeName;\n\n            // Reset UI elements\n            didYouKnowSection.classList.remove(\'visible\');\n            factRatingContainer.classList.remove(\'visible\');\n            favoriteFactBtn.classList.remove(\'favorited\');\n            resetStars();\n            updateFavoriteButtonState();\n            updateFactStreakDisplay();\n            updateMasteryDisplay();\n            hideQuiz();\n            hideChallenge();\n        }\n\n        function getRandomFact(excludeFact = null) {\n            const theme = themes[currentTheme];\n            let fact = theme.fact;\n            let didYouKnow = theme.didYouKnow;\n\n            // In a real application, you\'d have an array of facts per theme\n            // For this example, we only have one fact per theme, so we\'ll just return it.\n            // If we had multiple, we\'d pick a random one that isn\'t the excludeFact.\n            return { fact, didYouKnow };\n        }\n\n        function showNewFact() {\n            const { fact, didYouKnow } = getRandomFact(currentFact);\n            currentFact = fact;\n            currentDidYouKnow = didYouKnow;\n            didYouKnowText.textContent = currentDidYouKnow;\n            mainFactText.textContent = currentFact; // Directly display the fact\n\n            didYouKnowSection.classList.remove(\'visible\');\n            factRatingContainer.classList.remove(\'visible\');\n            favoriteFactBtn.classList.remove(\'favorited\');\n            resetStars();\n            updateFavoriteButtonState();\n            addFactToHistory(currentFact);\n            updateFactStreakDisplay();\n            updateMasteryDisplay();\n            hideQuiz();\n            hideChallenge();\n        }\n\n        function updateFavoriteButtonState() {\n            if (favoriteFacts.includes(currentFact)) {\n                favoriteFactBtn.classList.add(\'favorited\');\n                favoriteFactBtn.textContent = \'❤️ Favorited!\';\n            } else {\n                favoriteFactBtn.classList.remove(\'favorited\');\n                favoriteFactBtn.textContent = \'⭐ Favorite Fact\';\n            }\n        }\n\n        function toggleFavoriteFact() {\n            if (favoriteFacts.includes(currentFact)) {\n                favoriteFacts = favoriteFacts.filter(fact => fact !== currentFact);\n            } else {\n                favoriteFacts.push(currentFact);\n            }\n            localStorage.setItem(\'favoriteFacts\', JSON.stringify(favoriteFacts));\n            updateFavoriteButtonState();\n            renderFavoriteFacts();\n        }\n\n        function renderFavoriteFacts() {\n            favoriteFactsList.innerHTML = \'\';\n            if (favoriteFacts.length === 0) {\n                favoriteFactsList.innerHTML = \'<p>No favorite facts yet. Star some facts to save them!</p>\';\n                return;\n            }\n            favoriteFacts.forEach(fact => {\n                const factItem = document.createElement(\'div\');\n                factItem.classList.add(\'favorite-fact-item\');\n                factItem.innerHTML = `\n                    <span>${fact}</span>\n                    <button class=\"remove-fav-btn\" data-fact=\"${fact}\">Remove</button>\n                `;\n                favoriteFactsList.appendChild(factItem);\n            });\n\n            document.querySelectorAll(\'.remove-fav-btn\').forEach(button => {\n                button.addEventListener(\'click\', (e) => {\n                    const factToRemove = e.target.dataset.fact;\n                    favoriteFacts = favoriteFacts.filter(fact => fact !== factToRemove);\n                    localStorage.setItem(\'favoriteFacts\', JSON.stringify(favoriteFacts));\n                    renderFavoriteFacts();\n                    updateFavoriteButtonState();\n                });\n            });\n        }\n\n        function addFactToHistory(fact) {\n            if (!factHistory.includes(fact)) {\n                factHistory.unshift(fact); // Add to the beginning\n                if (factHistory.length > 10) { // Keep history to last 10 facts\n                    factHistory.pop();\n                }\n                localStorage.setItem(\'factHistory\', JSON.stringify(factHistory));\n            }\n            renderFactHistory();\n        }\n\n        function renderFactHistory() {\n            factHistoryList.innerHTML = \'\';\n            if (factHistory.length === 0) {\n                factHistoryList.innerHTML = \'<p>No fact history yet. Start exploring!</p>\';\n                return;\n            }\n            factHistory.forEach(fact => {\n                const factItem = document.createElement(\'div\');\n                factItem.classList.add(\'history-fact-item\');\n                factItem.innerHTML = `\n                    <span>${fact}</span>\n                `;\n                factHistoryList.appendChild(factItem);\n            });\n        }\n\n        function resetStars() {\n            stars.forEach(star => star.classList.remove(\'selected\'));\n        }\n\n        function setRating(rating) {\n            resetStars();\n            for (let i = 0; i < rating; i++) {\n                stars[i].classList.add(\'selected\');\n            }\n            factRatings[currentFact] = rating;\n            localStorage.setItem(\'factRatings\', JSON.stringify(factRatings));\n            updateMasteryDisplay();\n        }\n\n        function updateFactStreakDisplay() {\n            const streak = factStreaks[currentTheme] || 0;\n            currentStreakSpan.textContent = streak;\n            if (streak > 0) {\n                currentStreakSpan.classList.add(\'animate-pulse\');\n                setTimeout(() => currentStreakSpan.classList.remove(\'animate-pulse\'), 500);\n            }\n        }\n\n        function incrementStreak() {\n            factStreaks[currentTheme] = (factStreaks[currentTheme] || 0) + 1;\n            localStorage.setItem(\'factStreaks\', JSON.stringify(factStreaks));\n            updateFactStreakDisplay();\n        }\n\n        function resetStreak() {\n            factStreaks[currentTheme] = 0;\n            localStorage.setItem(\'factStreaks\', JSON.stringify(factStreaks));\n            updateFactStreakDisplay();\n        }\n\n        function updateMasteryDisplay() {\n            const allFactsInTheme = Object.values(themes).map(t => t.fact); // Simplified for this example\n            totalFactsCountSpan.textContent = allFactsInTheme.length;\n\n            const masteredCount = Object.keys(masteredFacts).filter(fact => allFactsInTheme.includes(fact)).length;\n            masteredFactsCountSpan.textContent = masteredCount;\n\n            const progress = allFactsInTheme.length > 0 ? (masteredCount / allFactsInTheme.length) * 100 : 0;\n            masteryProgressBar.style.width = `${progress}%`;\n        }\n\n        function markFactAsMastered(fact) {\n            masteredFacts[fact] = true;\n            localStorage.setItem(\'masteredFacts\', JSON.stringify(masteredFacts));\n            updateMasteryDisplay();\n        }\n\n        function generateQuiz() {\n            quizFeedback.textContent = \'\';\n            quizOptions.innerHTML = \'\';\n            nextQuizBtn.style.display = \'none\';\n\n            const allDidYouKnows = Object.values(themes).map(t => t.didYouKnow);\n            const correctDidYouKnow = currentDidYouKnow;\n            currentQuizFact = currentFact; // Still track the fact the quiz is about\n\n            // Simple question generation: take the first sentence of didYouKnow\n            const questionSentence = correctDidYouKnow.split(\'.\')[0] + \'.\';\n            quizQuestion.textContent = `Based on the fact, complete the statement: \"${questionSentence}\"`;\n\n            let options = [correctDidYouKnow];\n            while (options.length < 4) {\n                const randomDidYouKnow = allDidYouKnows[Math.floor(Math.random() * allDidYouKnows.length)];\n                if (!options.includes(randomDidYouKnow)) {\n                    options.push(randomDidYouKnow);\n                }\n            }\n            options.sort(() => Math.random() - 0.5); // Shuffle options\n\n            options.forEach(option => {\n                const button = document.createElement(\'button\');\n                button.classList.add(\'quiz-option-btn\');\n                button.textContent = option;\n                button.dataset.answer = option; // Use dataset.answer for the full text\n                button.addEventListener(\'click\', handleQuizAnswer);\n                quizOptions.appendChild(button);\n            });\n        }\n\n        function handleQuizAnswer(event) {\n            const selectedButton = event.target;\n            const selectedAnswer = selectedButton.dataset.answer;\n\n            // Disable all buttons after selection\n            document.querySelectorAll(\'.quiz-option-btn\').forEach(btn => btn.disabled = true);\n\n            if (selectedAnswer === currentDidYouKnow) {\n                selectedButton.classList.add(\'correct\');\n                quizFeedback.textContent = \'Correct! Well done!\';\n                quizFeedback.style.color = \'var(--correct-answer-color)\';\n                incrementStreak();\n                markFactAsMastered(currentQuizFact);\n            } else {\n                selectedButton.classList.add(\'incorrect\');\n                quizFeedback.textContent = \'Incorrect. Try again next time!\';\n                quizFeedback.style.color = \'var(--incorrect-answer-color)\';\n                // Highlight the correct answer\n                document.querySelectorAll(\'.quiz-option-btn\').forEach(btn => {\n                    if (btn.dataset.answer === currentDidYouKnow) {\n                        btn.classList.add(\'correct\');\n                    }\n                });\n                resetStreak();\n            }\n            nextQuizBtn.style.display = \'block\';\n        }\n\n        function showQuiz() {\n            factQuizContainer.classList.add(\'visible\');\n            quizMode = true;\n            generateQuiz();\n        }\n\n        function hideQuiz() {\n            factQuizContainer.classList.remove(\'visible\');\n            quizMode = false;\n        }\n\n        function generateChallenge() {\n            challengeFeedback.textContent = \'\';\n            challengeOptions.innerHTML = \'\';\n            nextChallengeBtn.style.display = \'none\';\n\n            const allThemesKeys = Object.keys(themes);\n            const correctThemeKey = allThemesKeys[Math.floor(Math.random() * allThemesKeys.length)];\n            const correctTheme = themes[correctThemeKey];\n            currentChallengeFact = correctTheme.fact;\n            currentChallengeCorrectOption = correctTheme.title;\n\n            let options = [correctTheme.title];\n            while (options.length < 4) {\n                const randomThemeKey = allThemesKeys[Math.floor(Math.random() * allThemesKeys.length)];\n                const randomThemeTitle = themes[randomThemeKey].title;\n                if (!options.includes(randomThemeTitle)) {\n                    options.push(randomThemeTitle);\n                }\n            }\n            options.sort(() => Math.random() - 0.5); // Shuffle options\n\n            challengeQuestion.textContent = `Which theme does this fact belong to: \"${currentChallengeFact}\"?`;\n\n            options.forEach(option => {\n                const button = document.createElement(\'button\');\n                button.classList.add(\'challenge-option-btn\');\n                button.textContent = option;\n                button.dataset.theme = option;\n                button.addEventListener(\'click\', handleChallengeAnswer);\n                challengeOptions.appendChild(button);\n            });\n        }\n\n        function handleChallengeAnswer(event) {\n            const selectedButton = event.target;\n            const selectedTheme = selectedButton.dataset.theme;\n\n            // Disable all buttons after selection\n            document.querySelectorAll(\'.challenge-option-btn\').forEach(btn => btn.disabled = true);\n\n            if (selectedTheme === currentChallengeCorrectOption) {\n                selectedButton.classList.add(\'correct\');\n                challengeFeedback.textContent = \'Excellent! You nailed it!\';\n                challengeFeedback.style.color = \'var(--correct-answer-color)\';\n                incrementStreak();\n                markFactAsMastered(currentChallengeFact);\n            } else {\n                selectedButton.classList.add(\'incorrect\');\n                challengeFeedback.textContent = `Oops! The correct theme was \"${currentChallengeCorrectOption}\".`;\n                challengeFeedback.style.color = \'var(--incorrect-answer-color)\';\n                // Highlight the correct answer\n                document.querySelectorAll(\'.challenge-option-btn\').forEach(btn => {\n                    if (btn.dataset.theme === currentChallengeCorrectOption) {\n                        btn.classList.add(\'correct\');\n                    }\n                });\n                resetStreak();\n            }\n            nextChallengeBtn.style.display = \'block\';\n        }\n\n        function showChallenge() {\n            factChallengeContainer.classList.add(\'visible\');\n            challengeMode = true;\n            generateChallenge();\n        }\n\n        function hideChallenge() {\n            factChallengeContainer.classList.remove(\'visible\');\n            challengeMode = false;\n        }\n\n        // Event Listeners\n        themeSelect.addEventListener(\'change\', (e) => {\n            currentTheme = e.target.value;\n            applyTheme(currentTheme);\n            showNewFact(); // Load a new fact for the selected theme\n        });\n\n        newFactBtn.addEventListener(\'click\', showNewFact);\n\n        favoriteFactBtn.addEventListener(\'click\', toggleFavoriteFact);\n\n        toggleDidYouKnowBtn.addEventListener(\'click\', () => {\n            didYouKnowSection.classList.toggle(\'visible\');\n        });\n\n        copyFactBtn.addEventListener(\'click\', () => {\n            navigator.clipboard.writeText(currentFact).then(() => {\n                alert(\'Fact copied to clipboard!\');\n            }).catch(err => {\n                console.error(\'Failed to copy fact: \', err);\n            });\n        });\n\n        shareTwitterBtn.addEventListener(\'click\', () => {\n            const tweetText = encodeURIComponent(`\"${currentFact}\" #WildWonders #FactOfTheDay`);\n            window.open(`https://twitter.com/intent/tweet?text=${tweetText}`, \'_blank\');\n        });\n\n        shareWhatsappBtn.addEventListener(\'click\', () => {\n            const whatsappText = encodeURIComponent(`Check out this amazing fact: \"${currentFact}\"`);\n            window.open(`https://api.whatsapp.com/send?text=${whatsappText}`, \'_blank\');\n        });\n\n        toggleFavoritesBtn.addEventListener(\'click\', () => {\n            favoriteFactsDisplay.classList.toggle(\'visible\');\n            if (favoriteFactsDisplay.classList.contains(\'visible\')) {\n                renderFavoriteFacts();\n            }\n            factHistoryDisplay.classList.remove(\'visible\'); // Hide history if favorites shown\n            hideQuiz();\n            hideChallenge();\n        });\n\n        toggleHistoryBtn.addEventListener(\'click\', () => {\n            factHistoryDisplay.classList.toggle(\'visible\');\n            if (factHistoryDisplay.classList.contains(\'visible\')) {\n                renderFactHistory();\n            }\n            favoriteFactsDisplay.classList.remove(\'visible\'); // Hide favorites if history shown\n            hideQuiz();\n            hideChallenge();\n        });\n\n        stars.forEach(star => {\n            star.addEventListener(\'click\', (e) => {\n                const rating = parseInt(e.target.dataset.value);\n                setRating(rating);\n            });\n        });\n\n        resetStreakBtn.addEventListener(\'click\', resetStreak);\n\n        toggleQuizBtn.addEventListener(\'click\', () => {\n            if (quizMode) {\n                hideQuiz();\n            } else {\n                showQuiz();\n                favoriteFactsDisplay.classList.remove(\'visible\');\n                factHistoryDisplay.classList.remove(\'visible\');\n                hideChallenge();\n            }\n        });\n\n        nextQuizBtn.addEventListener(\'click\', generateQuiz);\n\n        toggleChallengeBtn.addEventListener(\'click\', () => {\n            if (challengeMode) {\n                hideChallenge();\n            } else {\n                showChallenge();\n                favoriteFactsDisplay.classList.remove(\'visible\');\n                factHistoryDisplay.classList.remove(\'visible\');\n                hideQuiz();\n            }\n        });\n\n        nextChallengeBtn.addEventListener(\'click\', generateChallenge);\n\n        // Initial load\n        document.addEventListener(\'DOMContentLoaded\', () => {\n            currentTheme = \"deep-sea-mysteries\"; // Set initial theme to Deep Sea Mysteries\n            applyTheme(currentTheme);\n            addFactToHistory(currentFact);\n            updateFavoriteButtonState();\n            updateFactStreakDisplay();\n            updateMasteryDisplay();\n\n            // Set initial update time for the footer\n            const updateTimeElement = document.getElementById(\'update-time\');\n            const now = new Date();\n            updateTimeElement.textContent = now.toLocaleString();\n        });\n    </script>\n</body>\n</html>